var COMPILED=!0,goog=goog||{};goog.global=this;goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c=c[d]?c[d]:c[d]={}:c[d]=b};goog.define=function(a,b){var c=b;COMPILED||goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(c=goog.global.CLOSURE_DEFINES[a]);goog.exportPath_(a,c)};goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;
goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};
COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.getObjectByName=function(a,b){for(var c=a.split("."),d=b||goog.global,e;e=c.shift();)if(goog.isDefAndNotNull(d[e]))d=d[e];else return null;return d};goog.globalize=function(a,b){var c=b||goog.global,d;for(d in a)c[d]=a[d]};
goog.addDependency=function(a,b,c){if(goog.DEPENDENCIES_ENABLED){var d;a=a.replace(/\\/g,"/");for(var e=goog.dependencies_,f=0;d=b[f];f++)e.nameToPath[d]=a,a in e.pathToNames||(e.pathToNames[a]={}),e.pathToNames[a][d]=!0;for(d=0;b=c[d];d++)a in e.requires||(e.requires[a]={}),e.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a,b){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.DEPENDENCIES_ENABLED&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?"),d=-1==d?c.length:
d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){if(goog.inHtmlDocument_()){var b=goog.global.document;if("complete"==b.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}b.write('<script type="text/javascript" src="'+a+'">\x3c/script>');
return!0}return!1},goog.writeScripts_=function(){function a(e){if(!(e in d.written)){if(!(e in d.visited)&&(d.visited[e]=!0,e in d.requires))for(var g in d.requires[e])if(!goog.isProvided_(g))if(g in d.nameToPath)a(d.nameToPath[g]);else throw Error("Undefined nameToPath for "+g);e in c||(c[e]=!0,b.push(e))}}var b=[],c={},d=goog.dependencies_,e;for(e in goog.included_)d.written[e]||a(e);for(e=0;e<b.length;e++)if(b[e])goog.importScript_(goog.basePath+b[e]);else throw Error("Undefined script input");
},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);
b.body.removeChild(c)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")},d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};return b?a+"-"+d(b):d(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){var c=b||{},d;for(d in c){var e=(""+c[d]).replace(/\$/g,"$$$$");a=a.replace(RegExp("\\{\\$"+d+"\\}","gi"),e)}return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(goog.DEBUG&&!d)throw Error("arguments.caller not defined.  goog.base() expects not to be running in strict mode. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(d.superClass_)return d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),f=!1,g=a.constructor;g;g=g.superClass_&&g.superClass_.constructor)if(g.prototype[b]===d)f=!0;else if(f)return g.prototype[b].apply(a,
e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){a.call(goog.global)};goog.ime={};goog.ime.offline={};goog.ime.offline.InputToolCode={INPUTMETHOD_PINYIN_CHINESE_SIMPLIFIED:"zh-t-i0-pinyin",INPUTMETHOD_ZHUYIN_CHINESE_TRADITIONAL:"zh-hant-t-i0-und",INPUTMETHOD_CANGJIE87_CHINESE_TRADITIONAL:"zh-hant-t-i0-cangjie-1987"};goog.ime.chrome={};goog.ime.chrome.os={};goog.ime.chrome.os.EventType={KEYDOWN:"keydown",KEYUP:"keyup",COMMIT:"commit",MODELUPDATED:"update",CLOSING:"close",OPENING:"open"};goog.ime.chrome.os.Key={UP:"Up",DOWN:"Down",PAGE_UP:"Page_up",PAGE_DOWN:"Page_down",SPACE:" ",ENTER:"Enter",BACKSPACE:"Backspace",ESC:"Esc",LEFT:"Left",RIGHT:"Right",INVALID:"\ufffd"};goog.ime.chrome.os.Modifier={SHIFT:"Shift",CTRL:"Control",ALT:"Alt"};
goog.ime.chrome.os.KeyboardLayouts={STANDARD:"Default",GINYIEH:"Gin Yieh",ETEN:"Eten",IBM:"IBM",HSU:"Hsu",ETEN26:"Eten 26"};goog.ime.chrome.os.Status={INIT:0,FETCHING:1,FETCHED:2,SELECT:3};goog.ime.chrome.os.StateID={LANG:"lang",SBC:"sbc",PUNC:"punc"};goog.ime.chrome.os.TransID={BACK:0,TEXT:1,INSTANT:2};
goog.ime.chrome.os.MessageKey={SOURCE:"source",HIGHLIGHT:"highlight",APPEND:"append",DELETE:"delete",REVERT:"revert",CLEAR:"clear",IME:"ime",SELECT_HIGHLIGHT:"select_highlight",SELECT:"select",COMMIT:"commit",MULTI:"multi",FUZZY_PAIRS:"fuzzy_pairs",USER_DICT:"user_dict",COMMIT_MARK:"|"};goog.ime.chrome.os.LocalStorageHandler=function(){};goog.ime.chrome.os.LocalStorageHandler.prototype.getLocalStorageItem=function(a,b){var c=localStorage.getItem(a);return void 0==c?b:JSON.parse(c)};goog.ime.chrome.os.LocalStorageHandler.prototype.setLocalStorageItem=function(a,b){localStorage.setItem(a,JSON.stringify(b))};goog.ime.chrome.os.LocalStorageHandler.prototype.updateControllerSettings=function(a){};goog.ime.chrome.os.State=function(){this.shortcut=[]};goog.ime.chrome.os.State.prototype.desc="";goog.ime.chrome.os.State.prototype.value=!1;goog.ime.chrome.os.Config=function(){this.states={};this.fuzzyExpansions=[]};goog.ime.chrome.os.Config.prototype.punctuationReg=/[^a-z0-9 \r]/i;goog.ime.chrome.os.Config.prototype.editorCharReg=/[a-z]/i;goog.ime.chrome.os.Config.prototype.pageupCharReg=/xyz/g;goog.ime.chrome.os.Config.prototype.pagedownCharReg=/xyz/g;goog.ime.chrome.os.Config.prototype.pageSize=5;goog.ime.chrome.os.Config.prototype.maxInputLen=40;goog.ime.chrome.os.Config.prototype.requestNum=50;
goog.ime.chrome.os.Config.prototype.autoHighlight=!0;goog.ime.chrome.os.Config.prototype.enableUserDict=!0;goog.ime.chrome.os.Config.prototype.layout=goog.ime.chrome.os.KeyboardLayouts.STANDARD;goog.ime.chrome.os.Config.prototype.selectKeys="1234567890";goog.ime.chrome.os.Config.prototype.preTransform=function(a){return""};goog.ime.chrome.os.Config.prototype.transform=function(a,b){return b};goog.ime.chrome.os.Config.prototype.postTransform=function(a){return a};
goog.ime.chrome.os.Config.prototype.transformView=function(a){return a};goog.ime.chrome.os.ChineseConfig=function(){goog.ime.chrome.os.Config.call(this);this.sbcMap={};this.puncMap={"~":"\uff5e","!":"\uff01",$:"\uffe5","^":"\u2026\u2026","*":"\u00d7","(":"\uff08",")":"\uff09","-":"\uff0d",_:"\u2014\u2014","[":"\u3010","]":"\u3011","{":"\uff5b","}":"\uff5d","\\":"\u3001",";":"\uff1b",":":"\uff1a","'":["\u2018\u2019",0],'"':["\u201c\u201d",0],",":"\uff0c",".":"\u3002","<":"\u300a",">":"\u300b","?":"\uff1f"};for(var a=0;62>a;++a){var b="\uff10\uff11\uff12\uff13\uff14\uff15\uff16\uff17\uff18\uff19\uff41\uff42\uff43\uff44\uff45\uff46\uff47\uff48\uff49\uff4a\uff4b\uff4c\uff4d\uff4e\uff4f\uff50\uff51\uff52\uff53\uff54\uff55\uff56\uff57\uff58\uff59\uff5a\uff21\uff22\uff23\uff24\uff25\uff26\uff27\uff28\uff29\uff2a\uff2b\uff2c\uff2d\uff2e\uff2f\uff30\uff31\uff32\uff33\uff34\uff35\uff36\uff37\uff38\uff39\uff3a"[a];
10>a?this.sbcMap[String(a)]=b:36>a?this.sbcMap[String.fromCharCode(a+87)]=b:this.sbcMap[String.fromCharCode(a+29)]=b}var a=goog.ime.chrome.os.StateID,b=goog.ime.chrome.os.Modifier,c=new goog.ime.chrome.os.State;c.desc="Initial input language is Chinese";c.value=!0;c.shortcut=[b.SHIFT];var d=new goog.ime.chrome.os.State;d.desc="Initial character width is Full";d.value=!1;d.shortcut=[" ",b.SHIFT];var e=new goog.ime.chrome.os.State;e.desc="Initial punctuation width is Full";e.value=!0;e.shortcut=["\\.",
b.CTRL];this.states[a.LANG]=c;this.states[a.SBC]=d;this.states[a.PUNC]=e};goog.inherits(goog.ime.chrome.os.ChineseConfig,goog.ime.chrome.os.Config);
goog.ime.chrome.os.ChineseConfig.prototype.preTransform=function(a){var b=goog.ime.chrome.os.StateID;if(!this.states[b.LANG]||!this.states[b.SBC]||!this.states[b.PUNC])return"";if(this.states[b.SBC].value&&(!this.states[b.LANG].value||"0"<=a&&"9">=a)){var c=this.sbcMap[a];if(c)return c}return this.states[b.PUNC].value&&(b=this.puncMap[a])?(1<b.length&&(a=b[0].charAt(b[1]),b[1]^=1,b=a),b):""};
goog.ime.chrome.os.ChineseConfig.prototype.postTransform=function(a){var b=this.preTransform(a);return b?b:a};goog.ime.chrome.os.ZhuyinConfig=function(){goog.ime.chrome.os.ChineseConfig.call(this);this.bopomofoMap_={};this.vow_=/[\u3110-\u3129]/;this.ton_=/[\u02c7\u02c9-\u02cb\u02d9]/;this.init_()};goog.inherits(goog.ime.chrome.os.ZhuyinConfig,goog.ime.chrome.os.ChineseConfig);
goog.ime.chrome.os.ZhuyinConfig.Phonetics={B:"\u3105",P:"\u3106",M:"\u3107",F:"\u3108",D:"\u3109",T:"\u310a",N:"\u310b",L:"\u310c",K:"\u310e",G:"\u310d",H:"\u310f",J:"\u3110",Q:"\u3111",X:"\u3112",ZH:"\u3113",CH:"\u3114",SH:"\u3115",R:"\u3116",Z:"\u3117",C:"\u3118",S:"\u3119",I:"\u3127",U:"\u3128",UE:"\u3129",A:"\u311a",O:"\u311b",ER:"\u311c",E:"\u311d",AI:"\u311e",EI:"\u311f",AO:"\u3120",OU:"\u3121",AN:"\u3122",EN:"\u3123",ANG:"\u3124",ENG:"\u3125",ERR:"\u3126",TONE1:"\u02c9",TONE2:"\u02ca",TONE3:"\u02c7",
TONE4:"\u02cb",TONE5:"\u02d9"};
goog.ime.chrome.os.ZhuyinConfig.prototype.init_=function(){var a=goog.ime.chrome.os.KeyboardLayouts,b=goog.ime.chrome.os.ZhuyinConfig.Phonetics;this.bopomofoMap_[a.STANDARD]={1:b.B,q:b.P,a:b.M,z:b.F,2:b.D,w:b.T,s:b.N,x:b.L,e:b.G,d:b.K,c:b.H,r:b.J,f:b.Q,v:b.X,5:b.ZH,t:b.CH,g:b.SH,b:b.R,y:b.Z,h:b.C,n:b.S,u:b.I,j:b.U,m:b.UE,8:b.A,i:b.O,k:b.ER,",":b.E,9:b.AI,o:b.EI,l:b.AO,".":b.OU,0:b.AN,p:b.EN,";":b.ANG,"/":b.ENG,"-":b.ERR,3:b.TONE3,4:b.TONE4,6:b.TONE2,7:b.TONE5," ":b.TONE1,"=":"="};this.bopomofoMap_[a.IBM]=
{1:b.B,2:b.P,3:b.M,4:b.F,5:b.D,6:b.T,7:b.N,8:b.L,9:b.G,0:b.K,"-":b.H,q:b.J,w:b.Q,e:b.X,r:b.ZH,t:b.CH,y:b.SH,u:b.R,i:b.Z,o:b.C,p:b.S,a:b.I,s:b.U,d:b.UE,f:b.A,g:b.O,h:b.ER,j:b.E,k:b.AI,l:b.EI,";":b.AO,z:b.OU,x:b.AN,c:b.EN,v:b.ANG,b:b.ENG,n:b.ERR," ":b.TONE1,m:b.TONE2,",":b.TONE3,".":b.TONE4,"/":b.TONE5};this.bopomofoMap_[a.ETEN]={b:b.B,p:b.P,m:b.M,f:b.F,d:b.D,t:b.T,n:b.N,l:b.L,v:b.G,k:b.K,h:b.H,g:b.J,7:b.Q,c:b.X,",":b.ZH,".":b.CH,"/":b.SH,j:b.R,";":b.Z,"'":b.C,s:b.S,e:b.I,x:b.U,u:b.UE,a:b.A,o:b.O,r:b.ER,
w:b.E,i:b.AI,q:b.EI,z:b.AO,y:b.OU,8:b.AN,9:b.EN,0:b.ANG,"-":b.ENG,"=":b.ERR," ":b.TONE1,2:b.TONE2,3:b.TONE3,4:b.TONE4,1:b.TONE5};this.bopomofoMap_[a.GINYIEH]={"'":b.UE,",":b.E,"-":b.I,".":b.OU,"/":b.ENG,0:b.AN,1:b.TONE5,2:b.B,3:b.D,6:b.ZH,8:b.A,9:b.AI,";":b.ANG,"=":b.ERR,"[":b.U,a:b.TONE3,b:b.X,c:b.L,d:b.N,e:b.T,f:b.K,g:b.Q,h:b.SH,i:b.O,j:b.C,k:b.ER,l:b.AO,m:b.S,n:b.R,o:b.EI,p:b.EN,q:b.TONE2,r:b.G,s:b.M,t:b.J,u:b.Z,v:b.H,w:b.P,x:b.F,y:b.CH,z:b.TONE4};this.bopomofoMap_[a.HSU]={b:b.B,p:b.P,m:b.M+b.AN,
f:b.F+b.TONE3,d:b.D+b.TONE2,t:b.T,n:b.N+b.EN,l:b.L+b.ENG+b.ERR,g:b.G+b.ER,k:b.K+b.ANG,h:b.H+b.O,j:b.J+b.ZH+b.TONE4,v:b.Q+b.CH,c:b.X+b.SH,r:b.R,z:b.Z,a:b.C+b.EI,s:b.S+b.TONE5,e:b.I+b.E,x:b.U,u:b.UE,y:b.A,i:b.AI,w:b.AO,o:b.OU};this.bopomofoMap_[a.ETEN26]={b:b.B,p:b.P+b.OU,m:b.M+b.AN,f:b.F+b.TONE2,d:b.D+b.TONE5,t:b.T+b.ANG,n:b.N+b.EN,l:b.L+b.ENG,v:b.G+b.Q,k:b.K+b.TONE4,h:b.H+b.ERR,g:b.ZH+b.J,c:b.SH+b.X,y:b.CH,j:b.R+b.TONE3,q:b.Z+b.EI,w:b.C+b.E,s:b.S,e:b.I,x:b.U,u:b.UE,a:b.A,o:b.O,r:b.ER,i:b.AI,z:b.AO};
this.editorCharReg=/[a-z0-9\-;,.\/ ]/;this.punctuationReg=/xyz/;this.autoHighlight=!1};goog.ime.chrome.os.ZhuyinConfig.prototype.transform=function(a,b){var c=this.bopomofoMap_[this.layout][b];return!c||1==c.length&&c.match(this.ton_)&&!a.charAt(a.length-1).match(this.vow_)?"":c};goog.ime.chrome.os.PinyinConfig=function(){goog.ime.chrome.os.ChineseConfig.call(this);this.punctuationReg=/[^a-z0-9 \r]/i;this.editorCharReg=/[a-z\']/;this.pageupCharReg=/[=.]/;this.pagedownCharReg=/[\-,]/};goog.inherits(goog.ime.chrome.os.PinyinConfig,goog.ime.chrome.os.ChineseConfig);goog.object={};goog.object.forEach=function(a,b,c){for(var d in a)b.call(c,a[d],d,a)};goog.object.filter=function(a,b,c){var d={},e;for(e in a)b.call(c,a[e],e,a)&&(d[e]=a[e]);return d};goog.object.map=function(a,b,c){var d={},e;for(e in a)d[e]=b.call(c,a[e],e,a);return d};goog.object.some=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return!0;return!1};goog.object.every=function(a,b,c){for(var d in a)if(!b.call(c,a[d],d,a))return!1;return!0};
goog.object.getCount=function(a){var b=0,c;for(c in a)b++;return b};goog.object.getAnyKey=function(a){for(var b in a)return b};goog.object.getAnyValue=function(a){for(var b in a)return a[b]};goog.object.contains=function(a,b){return goog.object.containsValue(a,b)};goog.object.getValues=function(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b};goog.object.getKeys=function(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b};
goog.object.getValueByKeys=function(a,b){for(var c=goog.isArrayLike(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],goog.isDef(a));c++);return a};goog.object.containsKey=function(a,b){return b in a};goog.object.containsValue=function(a,b){for(var c in a)if(a[c]==b)return!0;return!1};goog.object.findKey=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d};goog.object.findValue=function(a,b,c){return(b=goog.object.findKey(a,b,c))&&a[b]};
goog.object.isEmpty=function(a){for(var b in a)return!1;return!0};goog.object.clear=function(a){for(var b in a)delete a[b]};goog.object.remove=function(a,b){var c;(c=b in a)&&delete a[b];return c};goog.object.add=function(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');goog.object.set(a,b,c)};goog.object.get=function(a,b,c){return b in a?a[b]:c};goog.object.set=function(a,b,c){a[b]=c};goog.object.setIfUndefined=function(a,b,c){return b in a?a[b]:a[b]=c};
goog.object.clone=function(a){var b={},c;for(c in a)b[c]=a[c];return b};goog.object.unsafeClone=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.object.unsafeClone(a[c]);return b}return a};goog.object.transpose=function(a){var b={},c;for(c in a)b[a[c]]=c;return b};goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.object.extend=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<goog.object.PROTOTYPE_FIELDS_.length;f++)c=goog.object.PROTOTYPE_FIELDS_[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};
goog.object.create=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c};goog.object.createSet=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};
goog.object.createImmutableView=function(a){var b=a;Object.isFrozen&&!Object.isFrozen(a)&&(b=Object.create(a),Object.freeze(b));return b};goog.object.isImmutableView=function(a){return!!Object.isFrozen&&Object.isFrozen(a)};goog.ime.chrome.os.CangjieConfig=function(){goog.ime.chrome.os.ChineseConfig.call(this);this.transMap_={a:"\u65e5",b:"\u6708",c:"\u91d1",d:"\u6728",e:"\u6c34",f:"\u706b",g:"\u571f",h:"\u7af9",i:"\u6208",j:"\u5341",k:"\u5927",l:"\u4e2d",m:"\u4e00",n:"\u5f13",o:"\u4eba",p:"\u5fc3",q:"\u624b",r:"\u53e3",s:"\u5c38",t:"\u5eff",u:"\u5c71",v:"\u5973",w:"\u7530",x:"\u96e3",y:"\u535c",z:"\u7b26"};this.punctuationReg=/[^a-z\'.* \r]/i;this.editorCharReg=/[a-z\'.*]/;this.pageupCharReg=/[=.]/;this.pagedownCharReg=
/[\-,]/;this.maxInputLen=5};goog.inherits(goog.ime.chrome.os.CangjieConfig,goog.ime.chrome.os.ChineseConfig);goog.ime.chrome.os.CangjieConfig.prototype.preTransform=function(a){return"*"==a&&this.states[goog.ime.chrome.os.StateID.LANG].value?"":goog.ime.chrome.os.CangjieConfig.superClass_.preTransform.call(this,a)};goog.ime.chrome.os.CangjieConfig.prototype.transformView=function(a){var b=this;return a.replace(/[a-z]/g,function(a){return b.transMap_[a]})};goog.ime.chrome.os.ConfigFactory=function(){this.inputToolCode_="";this.map_={};this.defaultConfig_=null};goog.addSingletonGetter(goog.ime.chrome.os.ConfigFactory);goog.ime.chrome.os.ConfigFactory.prototype.setInputTool=function(a){this.inputToolCode_=a};goog.ime.chrome.os.ConfigFactory.prototype.getInputTool=function(){return this.inputToolCode_};
goog.ime.chrome.os.ConfigFactory.prototype.getConfig=function(a){goog.object.isEmpty(this.map_)&&this.buildConfigs_();return this.map_[a]?this.map_[a]:null};goog.ime.chrome.os.ConfigFactory.prototype.getCurrentConfig=function(){goog.object.isEmpty(this.map_)&&this.buildConfigs_();var a=this.inputToolCode_;if(a&&this.map_[a])return this.map_[a];this.defaultConfig_||(this.defaultConfig_=new goog.ime.chrome.os.Config);return this.defaultConfig_};
goog.ime.chrome.os.ConfigFactory.prototype.buildConfigs_=function(){var a=goog.ime.offline.InputToolCode,b=new goog.ime.chrome.os.PinyinConfig;this.map_[a.INPUTMETHOD_PINYIN_CHINESE_SIMPLIFIED]=b;b=new goog.ime.chrome.os.ZhuyinConfig;this.map_[a.INPUTMETHOD_ZHUYIN_CHINESE_TRADITIONAL]=b;b=new goog.ime.chrome.os.CangjieConfig;this.map_[a.INPUTMETHOD_CANGJIE87_CHINESE_TRADITIONAL]=b};goog.ime.chrome.os.ZhuyinLocalStorageHandler=function(){this.keys_={LAYOUT:"zhuyin-lt",SELECT_KEYS:"zhuyin-sk",PAGE_SIZE:"zhuyin-ps"}};goog.inherits(goog.ime.chrome.os.ZhuyinLocalStorageHandler,goog.ime.chrome.os.LocalStorageHandler);goog.ime.chrome.os.ZhuyinLocalStorageHandler.prototype.getLayout=function(){return this.getLocalStorageItem(this.keys_.LAYOUT,goog.ime.chrome.os.KeyboardLayouts.STANDARD)};
goog.ime.chrome.os.ZhuyinLocalStorageHandler.prototype.getSelectKeys=function(){return this.getLocalStorageItem(this.keys_.SELECT_KEYS,"1234567890")};goog.ime.chrome.os.ZhuyinLocalStorageHandler.prototype.getPageSize=function(){return this.getLocalStorageItem(this.keys_.PAGE_SIZE,10)};goog.ime.chrome.os.ZhuyinLocalStorageHandler.prototype.setLayout=function(a){this.setLocalStorageItem(this.keys_.LAYOUT,a)};
goog.ime.chrome.os.ZhuyinLocalStorageHandler.prototype.setSelectKeys=function(a){this.setLocalStorageItem(this.keys_.SELECT_KEYS,a)};goog.ime.chrome.os.ZhuyinLocalStorageHandler.prototype.setPageSize=function(a){this.setLocalStorageItem(this.keys_.PAGE_SIZE,a)};
goog.ime.chrome.os.ZhuyinLocalStorageHandler.prototype.updateControllerSettings=function(a){var b=goog.ime.offline.InputToolCode.INPUTMETHOD_ZHUYIN_CHINESE_TRADITIONAL,c=this.getLayout(),d=this.getSelectKeys(),e=Number(this.getPageSize());a.setPageSettings(b,c,d,e);a=goog.ime.chrome.os.KeyboardLayouts;b=goog.ime.chrome.os.ConfigFactory.getInstance().getConfig(b);b.autoHighlight=b.layout!=a.HSU&&b.layout!=a.ETEN26||"1234567890"!=b.selectKeys?!1:!0};goog.ime.chrome.os.PinyinLocalStorageHandler=function(){this.fuzzyPinyinExpansionPairs_={an_ang:void 0,c_ch:void 0,en_eng:void 0,f_h:void 0,ian_iang:void 0,in_ing:void 0,k_g:void 0,l_n:void 0,r_l:void 0,s_sh:void 0,uan_uang:void 0,z_zh:void 0};this.keys_={FUZZY_PINYIN_ENABLED:"pinyin-fpe",USER_DICT_ENABLED:"pinyin-ud",FUZZY_EXPANSIONS:"pinyin-fe",TOP_PAGE:"pinyin-tp",BOTTOM_PAGE:"pinyin-bp",INIT_LANG:"pinyin-il",INIT_SBC:"pinyin-is",INIT_PUNC:"pinyin-ip"}};
goog.inherits(goog.ime.chrome.os.PinyinLocalStorageHandler,goog.ime.chrome.os.LocalStorageHandler);goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.getFuzzyPinyinEnabled=function(){return!!this.getLocalStorageItem(this.keys_.FUZZY_PINYIN_ENABLED,!1)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.getUserDictEnabled=function(){return!!this.getLocalStorageItem(this.keys_.USER_DICT_ENABLED,!0)};
goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.getFuzzyExpansions=function(){return this.getLocalStorageItem(this.keys_.FUZZY_EXPANSIONS,this.fuzzyPinyinExpansionPairs_)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.getTopPageEnabled=function(){return!!this.getLocalStorageItem(this.keys_.TOP_PAGE,!0)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.getBottomPageEnabled=function(){return!!this.getLocalStorageItem(this.keys_.BOTTOM_PAGE,!0)};
goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.getInitLang=function(){return!!this.getLocalStorageItem(this.keys_.INIT_LANG,!0)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.getInitSBC=function(){return!!this.getLocalStorageItem(this.keys_.INIT_SBC,!1)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.getInitPunc=function(){return!!this.getLocalStorageItem(this.keys_.INIT_PUNC,!0)};
goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.setFuzzyPinyinEnabled=function(a){this.setLocalStorageItem(this.keys_.FUZZY_PINYIN_ENABLED,a)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.setUserDictEnabled=function(a){this.setLocalStorageItem(this.keys_.USER_DICT_ENABLED,a)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.setFuzzyExpansions=function(a){this.setLocalStorageItem(this.keys_.FUZZY_EXPANSIONS,a)};
goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.setTopPageEnabled=function(a){this.setLocalStorageItem(this.keys_.TOP_PAGE,a)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.setBottomPageEnabled=function(a){this.setLocalStorageItem(this.keys_.BOTTOM_PAGE,a)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.setInitLang=function(a){this.setLocalStorageItem(this.keys_.INIT_LANG,a)};
goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.setInitSBC=function(a){this.setLocalStorageItem(this.keys_.INIT_SBC,a)};goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.setInitPunc=function(a){this.setLocalStorageItem(this.keys_.INIT_PUNC,a)};
goog.ime.chrome.os.PinyinLocalStorageHandler.prototype.updateControllerSettings=function(a){var b=goog.ime.offline.InputToolCode.INPUTMETHOD_PINYIN_CHINESE_SIMPLIFIED,c=this.getFuzzyPinyinEnabled(),d=this.getFuzzyExpansions();a.setFuzzyExpansions(b,c,d);c=this.getUserDictEnabled();a.setUserDictEnabled(b,c);d=c="";this.getTopPageEnabled()&&(c+="=",d+="\\-");this.getBottomPageEnabled()&&(c+=".",d+=",");a.setPageMoveChars(b,c,d);var c=this.getInitLang(),d=this.getInitSBC(),e=this.getInitPunc();a.setInputToolStates(b,
c,d,e)};goog.ime.chrome.os.LocalStorageHandlerFactory=function(){this.map_={};this.init_()};goog.addSingletonGetter(goog.ime.chrome.os.LocalStorageHandlerFactory);goog.ime.chrome.os.LocalStorageHandlerFactory.prototype.getLocalStorageHandler=function(a){return this.map_[a]?this.map_[a]:null};goog.ime.chrome.os.LocalStorageHandlerFactory.prototype.getAllLocalStorageHandlers=function(){return goog.object.getValues(this.map_)};
goog.ime.chrome.os.LocalStorageHandlerFactory.prototype.init_=function(){var a=goog.ime.offline.InputToolCode,b=new goog.ime.chrome.os.PinyinLocalStorageHandler;this.map_[a.INPUTMETHOD_PINYIN_CHINESE_SIMPLIFIED]=b;b=new goog.ime.chrome.os.ZhuyinLocalStorageHandler;this.map_[a.INPUTMETHOD_ZHUYIN_CHINESE_TRADITIONAL]=b};goog.ime.chrome.os.Candidate=function(a,b,c){this.target=a;this.range=b;this.annotation=c||""};goog.disposable={};goog.disposable.IDisposable=function(){};goog.Disposable=function(){goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&(this.creationStack=Error().stack,goog.Disposable.instances_[goog.getUid(this)]=this)};goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2};goog.Disposable.MONITORING_MODE=0;goog.Disposable.instances_={};goog.Disposable.getUndisposedObjects=function(){var a=[],b;for(b in goog.Disposable.instances_)goog.Disposable.instances_.hasOwnProperty(b)&&a.push(goog.Disposable.instances_[Number(b)]);return a};
goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=!1;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;
goog.Disposable.prototype.dispose=function(){if(!this.disposed_&&(this.disposed_=!0,this.disposeInternal(),goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF)){var a=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(a))throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call");delete goog.Disposable.instances_[a]}};
goog.Disposable.prototype.registerDisposable=function(a){this.addOnDisposeCallback(goog.partial(goog.dispose,a))};goog.Disposable.prototype.addOnDisposeCallback=function(a,b){this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]);this.onDisposeCallbacks_.push(goog.bind(a,b))};goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()};
goog.Disposable.isDisposed=function(a){return a&&"function"==typeof a.isDisposed?a.isDisposed():!1};goog.dispose=function(a){a&&"function"==typeof a.dispose&&a.dispose()};goog.disposeAll=function(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];goog.isArrayLike(d)?goog.disposeAll.apply(null,d):goog.dispose(d)}};goog.ime.offline.Candidate=function(a,b,c){this.range=a;this.target=b;this.score=c};goog.structs={};goog.structs.Node=function(a,b){this.key_=a;this.value_=b};goog.structs.Node.prototype.getKey=function(){return this.key_};goog.structs.Node.prototype.getValue=function(){return this.value_};goog.structs.Node.prototype.clone=function(){return new goog.structs.Node(this.key_,this.value_)};goog.debug={};goog.debug.Error=function(a){Error.captureStackTrace?Error.captureStackTrace(this,goog.debug.Error):this.stack=Error().stack||"";a&&(this.message=String(a))};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.string={};goog.string.Unicode={NBSP:"\u00a0"};goog.string.startsWith=function(a,b){return 0==a.lastIndexOf(b,0)};goog.string.endsWith=function(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c};goog.string.caseInsensitiveStartsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(0,b.length))};goog.string.caseInsensitiveEndsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(a.length-b.length,b.length))};
goog.string.caseInsensitiveEquals=function(a,b){return a.toLowerCase()==b.toLowerCase()};goog.string.subs=function(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")};goog.string.collapseWhitespace=function(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmpty=function(a){return/^[\s\xa0]*$/.test(a)};goog.string.isEmptySafe=function(a){return goog.string.isEmpty(goog.string.makeSafe(a))};
goog.string.isBreakingWhitespace=function(a){return!/[^\t\n\r ]/.test(a)};goog.string.isAlpha=function(a){return!/[^a-zA-Z]/.test(a)};goog.string.isNumeric=function(a){return!/[^0-9]/.test(a)};goog.string.isAlphaNumeric=function(a){return!/[^a-zA-Z0-9]/.test(a)};goog.string.isSpace=function(a){return" "==a};goog.string.isUnicodeChar=function(a){return 1==a.length&&" "<=a&&"~">=a||"\u0080"<=a&&"\ufffd">=a};goog.string.stripNewlines=function(a){return a.replace(/(\r\n|\r|\n)+/g," ")};
goog.string.canonicalizeNewlines=function(a){return a.replace(/(\r\n|\r|\n)/g,"\n")};goog.string.normalizeWhitespace=function(a){return a.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(a){return a.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};
goog.string.trimLeft=function(a){return a.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(a){return a.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(a,b){var c=String(a).toLowerCase(),d=String(b).toLowerCase();return c<d?-1:c==d?0:1};goog.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g;
goog.string.numerateCompare=function(a,b){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var c=a.toLowerCase().match(goog.string.numerateCompareRegExp_),d=b.toLowerCase().match(goog.string.numerateCompareRegExp_),e=Math.min(c.length,d.length),f=0;f<e;f++){var g=c[f],h=d[f];if(g!=h)return c=parseInt(g,10),!isNaN(c)&&(d=parseInt(h,10),!isNaN(d)&&c-d)?c-d:g<h?-1:1}return c.length!=d.length?c.length-d.length:a<b?-1:1};goog.string.urlEncode=function(a){return encodeURIComponent(String(a))};
goog.string.urlDecode=function(a){return decodeURIComponent(a.replace(/\+/g," "))};goog.string.newLineToBr=function(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")};
goog.string.htmlEscape=function(a,b){if(b)return a.replace(goog.string.amperRe_,"&amp;").replace(goog.string.ltRe_,"&lt;").replace(goog.string.gtRe_,"&gt;").replace(goog.string.quotRe_,"&quot;");if(!goog.string.allRe_.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(goog.string.amperRe_,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(goog.string.ltRe_,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(goog.string.gtRe_,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(goog.string.quotRe_,"&quot;"));return a};
goog.string.amperRe_=/&/g;goog.string.ltRe_=/</g;goog.string.gtRe_=/>/g;goog.string.quotRe_=/\"/g;goog.string.allRe_=/[&<>\"]/;goog.string.unescapeEntities=function(a){return goog.string.contains(a,"&")?"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(a):goog.string.unescapePureXmlEntities_(a):a};
goog.string.unescapeEntitiesUsingDom_=function(a){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},c=document.createElement("div");return a.replace(goog.string.HTML_ENTITY_PATTERN_,function(a,e){var f=b[a];if(f)return f;if("#"==e.charAt(0)){var g=Number("0"+e.substr(1));isNaN(g)||(f=String.fromCharCode(g))}f||(c.innerHTML=a+" ",f=c.firstChild.nodeValue.slice(0,-1));return b[a]=f})};
goog.string.unescapePureXmlEntities_=function(a){return a.replace(/&([^;]+);/g,function(a,c){switch(c){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if("#"==c.charAt(0)){var d=Number("0"+c.substr(1));if(!isNaN(d))return String.fromCharCode(d)}return a}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(a,b){return goog.string.newLineToBr(a.replace(/  /g," &#160;"),b)};
goog.string.stripQuotes=function(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a};goog.string.truncate=function(a,b,c){c&&(a=goog.string.unescapeEntities(a));a.length>b&&(a=a.substring(0,b-3)+"...");c&&(a=goog.string.htmlEscape(a));return a};
goog.string.truncateMiddle=function(a,b,c,d){c&&(a=goog.string.unescapeEntities(a));if(d&&a.length>b){d>b&&(d=b);var e=a.length-d;a=a.substring(0,b-d)+"..."+a.substring(e)}else a.length>b&&(d=Math.floor(b/2),e=a.length-d,a=a.substring(0,d+b%2)+"..."+a.substring(e));c&&(a=goog.string.htmlEscape(a));return a};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"};goog.string.jsEscapeCache_={"'":"\\'"};
goog.string.quote=function(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0);b[c+1]=goog.string.specialEscapeChars_[d]||(31<e&&127>e?d:goog.string.escapeChar(d))}b.push('"');return b.join("")};goog.string.escapeString=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=goog.string.escapeChar(a.charAt(c));return b.join("")};
goog.string.escapeChar=function(a){if(a in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[a];if(a in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[a]=goog.string.specialEscapeChars_[a];var b=a,c=a.charCodeAt(0);if(31<c&&127>c)b=a;else{if(256>c){if(b="\\x",16>c||256<c)b+="0"}else b="\\u",4096>c&&(b+="0");b+=c.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[a]=b};goog.string.toMap=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=!0;return b};
goog.string.contains=function(a,b){return-1!=a.indexOf(b)};goog.string.countOf=function(a,b){return a&&b?a.split(b).length-1:0};goog.string.removeAt=function(a,b,c){var d=a;0<=b&&(b<a.length&&0<c)&&(d=a.substr(0,b)+a.substr(b+c,a.length-b-c));return d};goog.string.remove=function(a,b){var c=RegExp(goog.string.regExpEscape(b),"");return a.replace(c,"")};goog.string.removeAll=function(a,b){var c=RegExp(goog.string.regExpEscape(b),"g");return a.replace(c,"")};
goog.string.regExpEscape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=function(a,b){return Array(b+1).join(a)};goog.string.padNumber=function(a,b,c){a=goog.isDef(c)?a.toFixed(c):String(a);c=a.indexOf(".");-1==c&&(c=a.length);return goog.string.repeat("0",Math.max(0,b-c))+a};goog.string.makeSafe=function(a){return null==a?"":String(a)};goog.string.buildString=function(a){return Array.prototype.join.call(arguments,"")};
goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)};
goog.string.compareVersions=function(a,b){for(var c=0,d=goog.string.trim(String(a)).split("."),e=goog.string.trim(String(b)).split("."),f=Math.max(d.length,e.length),g=0;0==c&&g<f;g++){var h=d[g]||"",k=e[g]||"",l=RegExp("(\\d*)(\\D*)","g"),n=RegExp("(\\d*)(\\D*)","g");do{var m=l.exec(h)||["","",""],p=n.exec(k)||["","",""];if(0==m[0].length&&0==p[0].length)break;var c=0==m[1].length?0:parseInt(m[1],10),q=0==p[1].length?0:parseInt(p[1],10),c=goog.string.compareElements_(c,q)||goog.string.compareElements_(0==
m[2].length,0==p[2].length)||goog.string.compareElements_(m[2],p[2])}while(0==c)}return c};goog.string.compareElements_=function(a,b){return a<b?-1:a>b?1:0};goog.string.HASHCODE_MAX_=4294967296;goog.string.hashCode=function(a){for(var b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=goog.string.HASHCODE_MAX_;return b};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};
goog.string.toNumber=function(a){var b=Number(a);return 0==b&&goog.string.isEmpty(a)?NaN:b};goog.string.isLowerCamelCase=function(a){return/^[a-z]+([A-Z][a-z]*)*$/.test(a)};goog.string.isUpperCamelCase=function(a){return/^([A-Z][a-z]*)+$/.test(a)};goog.string.toCamelCase=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};goog.string.toSelectorCase=function(a){return String(a).replace(/([A-Z])/g,"-$1").toLowerCase()};
goog.string.toTitleCase=function(a,b){var c=goog.isString(b)?goog.string.regExpEscape(b):"\\s";return a.replace(RegExp("(^"+(c?"|["+c+"]+":"")+")([a-z])","g"),function(a,b,c){return b+c.toUpperCase()})};goog.string.parseInt=function(a){isFinite(a)&&(a=String(a));return goog.isString(a)?/^\s*-?0x/i.test(a)?parseInt(a,16):parseInt(a,10):NaN};goog.string.splitLimit=function(a,b,c){a=a.split(b);for(var d=[];0<c&&a.length;)d.push(a.shift()),c--;a.length&&d.push(a.join(b));return d};goog.asserts={};goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(a,b){b.unshift(a);goog.debug.Error.call(this,goog.string.subs.apply(null,b));b.shift();this.messagePattern=a};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.doAssertFailure_=function(a,b,c,d){var e="Assertion failed";if(c)var e=e+(": "+c),f=d;else a&&(e+=": "+a,f=b);throw new goog.asserts.AssertionError(""+e,f||[]);};
goog.asserts.assert=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!a&&goog.asserts.doAssertFailure_("",null,b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.fail=function(a,b){if(goog.asserts.ENABLE_ASSERTS)throw new goog.asserts.AssertionError("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};
goog.asserts.assertNumber=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(a)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertString=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isString(a)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertFunction=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(a)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertObject=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isObject(a)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertArray=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isArray(a)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertBoolean=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(a)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertInstanceof=function(a,b,c,d){!goog.asserts.ENABLE_ASSERTS||a instanceof b||goog.asserts.doAssertFailure_("instanceof check failed.",null,c,Array.prototype.slice.call(arguments,3));return a};goog.array={};goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE;goog.array.peek=function(a){return a[a.length-1]};goog.array.ARRAY_PROTOTYPE_=Array.prototype;
goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.indexOf?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(goog.isString(a))return goog.isString(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};
goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.lastIndexOf?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.lastIndexOf.call(a,b,null==c?a.length-1:c)}:function(a,b,c){c=null==c?a.length-1:c;0>c&&(c=Math.max(0,a.length+c));if(goog.isString(a))return goog.isString(b)&&1==b.length?a.lastIndexOf(b,c):-1;for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1};
goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.forEach?function(a,b,c){goog.asserts.assert(null!=a.length);goog.array.ARRAY_PROTOTYPE_.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};goog.array.forEachRight=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,d=d-1;0<=d;--d)d in e&&b.call(c,e[d],d,a)};
goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.filter?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=goog.isString(a)?a.split(""):a,h=0;h<d;h++)if(h in g){var k=g[h];b.call(c,k,h,a)&&(e[f++]=k)}return e};
goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.map?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=goog.isString(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};goog.array.reduce=function(a,b,c,d){if(a.reduce)return d?a.reduce(goog.bind(b,d),c):a.reduce(b,c);var e=c;goog.array.forEach(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.reduceRight=function(a,b,c,d){if(a.reduceRight)return d?a.reduceRight(goog.bind(b,d),c):a.reduceRight(b,c);var e=c;goog.array.forEachRight(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.some?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};
goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.every?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};goog.array.count=function(a,b,c){var d=0;goog.array.forEach(a,function(a,f,g){b.call(c,a,f,g)&&++d},c);return d};
goog.array.find=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};goog.array.findIndex=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1};goog.array.findRight=function(a,b,c){b=goog.array.findIndexRight(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};
goog.array.findIndexRight=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,d=d-1;0<=d;d--)if(d in e&&b.call(c,e[d],d,a))return d;return-1};goog.array.contains=function(a,b){return 0<=goog.array.indexOf(a,b)};goog.array.isEmpty=function(a){return 0==a.length};goog.array.clear=function(a){if(!goog.isArray(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0};goog.array.insert=function(a,b){goog.array.contains(a,b)||a.push(b)};
goog.array.insertAt=function(a,b,c){goog.array.splice(a,c,0,b)};goog.array.insertArrayAt=function(a,b,c){goog.partial(goog.array.splice,a,c,0).apply(null,b)};goog.array.insertBefore=function(a,b,c){var d;2==arguments.length||0>(d=goog.array.indexOf(a,c))?a.push(b):goog.array.insertAt(a,b,d)};goog.array.remove=function(a,b){var c=goog.array.indexOf(a,b),d;(d=0<=c)&&goog.array.removeAt(a,c);return d};
goog.array.removeAt=function(a,b){goog.asserts.assert(null!=a.length);return 1==goog.array.ARRAY_PROTOTYPE_.splice.call(a,b,1).length};goog.array.removeIf=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0<=b?(goog.array.removeAt(a,b),!0):!1};goog.array.concat=function(a){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};goog.array.toArray=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};goog.array.clone=goog.array.toArray;
goog.array.extend=function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(goog.isArray(d)||(e=goog.isArrayLike(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,h=0;h<g;h++)a[f+h]=d[h];else a.push(d)}};goog.array.splice=function(a,b,c,d){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.splice.apply(a,goog.array.slice(arguments,1))};
goog.array.slice=function(a,b,c){goog.asserts.assert(null!=a.length);return 2>=arguments.length?goog.array.ARRAY_PROTOTYPE_.slice.call(a,b):goog.array.ARRAY_PROTOTYPE_.slice.call(a,b,c)};goog.array.removeDuplicates=function(a,b){for(var c=b||a,d={},e=0,f=0;f<a.length;){var g=a[f++],h=goog.isObject(g)?"o"+goog.getUid(g):(typeof g).charAt(0)+g;Object.prototype.hasOwnProperty.call(d,h)||(d[h]=!0,c[e++]=g)}c.length=e};
goog.array.binarySearch=function(a,b,c){return goog.array.binarySearch_(a,c||goog.array.defaultCompare,!1,b)};goog.array.binarySelect=function(a,b,c){return goog.array.binarySearch_(a,b,!0,void 0,c)};goog.array.binarySearch_=function(a,b,c,d,e){for(var f=0,g=a.length,h;f<g;){var k=f+g>>1,l;l=c?b.call(e,a[k],k,a):b(d,a[k]);0<l?f=k+1:(g=k,h=!l)}return h?f:~f};goog.array.sort=function(a,b){goog.asserts.assert(null!=a.length);goog.array.ARRAY_PROTOTYPE_.sort.call(a,b||goog.array.defaultCompare)};
goog.array.stableSort=function(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var d=b||goog.array.defaultCompare;goog.array.sort(a,function(a,b){return d(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value};goog.array.sortObjectsByKey=function(a,b,c){var d=c||goog.array.defaultCompare;goog.array.sort(a,function(a,c){return d(a[b],c[b])})};
goog.array.isSorted=function(a,b,c){b=b||goog.array.defaultCompare;for(var d=1;d<a.length;d++){var e=b(a[d-1],a[d]);if(0<e||0==e&&c)return!1}return!0};goog.array.equals=function(a,b,c){if(!goog.isArrayLike(a)||!goog.isArrayLike(b)||a.length!=b.length)return!1;var d=a.length;c=c||goog.array.defaultCompareEquality;for(var e=0;e<d;e++)if(!c(a[e],b[e]))return!1;return!0};goog.array.compare=function(a,b,c){return goog.array.equals(a,b,c)};
goog.array.compare3=function(a,b,c){c=c||goog.array.defaultCompare;for(var d=Math.min(a.length,b.length),e=0;e<d;e++){var f=c(a[e],b[e]);if(0!=f)return f}return goog.array.defaultCompare(a.length,b.length)};goog.array.defaultCompare=function(a,b){return a>b?1:a<b?-1:0};goog.array.defaultCompareEquality=function(a,b){return a===b};goog.array.binaryInsert=function(a,b,c){c=goog.array.binarySearch(a,b,c);return 0>c?(goog.array.insertAt(a,b,-(c+1)),!0):!1};
goog.array.binaryRemove=function(a,b,c){b=goog.array.binarySearch(a,b,c);return 0<=b?goog.array.removeAt(a,b):!1};goog.array.bucket=function(a,b,c){for(var d={},e=0;e<a.length;e++){var f=a[e],g=b.call(c,f,e,a);goog.isDef(g)&&(d[g]||(d[g]=[])).push(f)}return d};goog.array.toObject=function(a,b,c){var d={};goog.array.forEach(a,function(e,f){d[b.call(c,e,f,a)]=e});return d};
goog.array.range=function(a,b,c){var d=[],e=0,f=a;c=c||1;void 0!==b&&(e=a,f=b);if(0>c*(f-e))return[];if(0<c)for(a=e;a<f;a+=c)d.push(a);else for(a=e;a>f;a+=c)d.push(a);return d};goog.array.repeat=function(a,b){for(var c=[],d=0;d<b;d++)c[d]=a;return c};goog.array.flatten=function(a){for(var b=[],c=0;c<arguments.length;c++){var d=arguments[c];goog.isArray(d)?b.push.apply(b,goog.array.flatten.apply(null,d)):b.push(d)}return b};
goog.array.rotate=function(a,b){goog.asserts.assert(null!=a.length);a.length&&(b%=a.length,0<b?goog.array.ARRAY_PROTOTYPE_.unshift.apply(a,a.splice(-b,b)):0>b&&goog.array.ARRAY_PROTOTYPE_.push.apply(a,a.splice(0,-b)));return a};goog.array.zip=function(a){if(!arguments.length)return[];for(var b=[],c=0;;c++){for(var d=[],e=0;e<arguments.length;e++){var f=arguments[e];if(c>=f.length)return b;d.push(f[c])}b.push(d)}};
goog.array.shuffle=function(a,b){for(var c=b||Math.random,d=a.length-1;0<d;d--){var e=Math.floor(c()*(d+1)),f=a[d];a[d]=a[e];a[e]=f}};goog.ime.offline.Heap=function(a){this.nodes_=[];a&&this.insertAll(a)};goog.ime.offline.Heap.prototype.insert=function(a,b){var c=new goog.structs.Node(a,b),d=this.nodes_;d.push(c);this.moveUp_(d.length-1)};goog.ime.offline.Heap.prototype.increase=function(a,b){var c=goog.array.findIndex(this.nodes_,function(a){return a.getValue()==b});if(0>c)this.insert(a,b);else{var d=this.nodes_[c].getKey();a>d&&(this.nodes_[c]=new goog.structs.Node(a,b),this.moveDown_(c))}};
goog.ime.offline.Heap.prototype.decrease=function(a,b){var c=goog.array.findIndex(this.nodes_,function(a){return a.getValue()==b});if(0>c)this.insert(a,b);else{var d=this.nodes_[c].getKey();a<d&&(this.nodes_[c]=new goog.structs.Node(a,b),this.moveUp_(c))}};
goog.ime.offline.Heap.prototype.set=function(a,b){var c=goog.array.findIndex(this.nodes_,function(a){return a.getValue()==b});if(0>c)this.insert(a,b);else{var d=this.nodes_[c].getKey();this.nodes_[c]=new goog.structs.Node(a,b);a<d?this.moveUp_(c):this.moveDown_(c)}};
goog.ime.offline.Heap.prototype.insertAll=function(a){var b,c;if(a instanceof goog.ime.offline.Heap){if(b=a.getKeys(),c=a.getValues(),0>=a.getCount()){a=this.nodes_;for(var d=0;d<b.length;d++)a.push(new goog.structs.Node(b[d],c[d]));return}}else b=goog.object.getKeys(a),c=goog.object.getValues(a);for(d=0;d<b.length;d++)this.insert(b[d],c[d])};
goog.ime.offline.Heap.prototype.remove=function(){var a=this.nodes_,b=a.length,c=a[0];if(!(0>=b))return 1==b?goog.array.clear(a):(a[0]=a.pop(),this.moveDown_(0)),c.getValue()};goog.ime.offline.Heap.prototype.peek=function(){var a=this.nodes_;return 0==a.length?void 0:a[0].getValue()};goog.ime.offline.Heap.prototype.peekKey=function(){return this.nodes_[0]&&this.nodes_[0].getKey()};
goog.ime.offline.Heap.prototype.moveDown_=function(a){for(var b=this.nodes_,c=b.length,d=b[a];a<c>>1;){var e=this.getLeftChildIndex_(a),f=this.getRightChildIndex_(a),e=f<c&&b[f].getKey()<b[e].getKey()?f:e;if(b[e].getKey()>d.getKey())break;b[a]=b[e];a=e}b[a]=d};goog.ime.offline.Heap.prototype.moveUp_=function(a){for(var b=this.nodes_,c=b[a];0<a;){var d=this.getParentIndex_(a);if(b[d].getKey()>c.getKey())b[a]=b[d],a=d;else break}b[a]=c};
goog.ime.offline.Heap.prototype.getLeftChildIndex_=function(a){return 2*a+1};goog.ime.offline.Heap.prototype.getRightChildIndex_=function(a){return 2*a+2};goog.ime.offline.Heap.prototype.getParentIndex_=function(a){return a-1>>1};goog.ime.offline.Heap.prototype.getValues=function(){for(var a=this.nodes_,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getValue());return b};goog.ime.offline.Heap.prototype.getKeys=function(){for(var a=this.nodes_,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getKey());return b};
goog.ime.offline.Heap.prototype.containsValue=function(a){return goog.array.some(this.nodes_,function(b){return b.getValue()==a})};goog.ime.offline.Heap.prototype.containsKey=function(a){return goog.array.some(this.nodes_,function(b){return b.getKey()==a})};goog.ime.offline.Heap.prototype.clone=function(){return new goog.ime.offline.Heap(this)};goog.ime.offline.Heap.prototype.getCount=function(){return this.nodes_.length};goog.ime.offline.Heap.prototype.isEmpty=function(){return goog.array.isEmpty(this.nodes_)};
goog.ime.offline.Heap.prototype.clear=function(){goog.array.clear(this.nodes_)};goog.ime.offline.UserDecoder=function(a){this.inputTool_=a;this.latestMap_={};this.latestMapSize_=0;this.permantMap_={};this.init_()};goog.ime.offline.UserDecoder.MAX_PERMANT_SIZE=1500;goog.ime.offline.UserDecoder.MAX_LATEST_SIZE=300;goog.ime.offline.UserDecoder.LATEST_FACTOR=5;goog.ime.offline.UserDecoder.prototype.init_=function(){if(localStorage){var a=localStorage.getItem(this.getKey_());a&&(this.permantMap_=JSON.parse(a))}};
goog.ime.offline.UserDecoder.prototype.add=function(a,b){this.latestMap_[a]?this.latestMap_[a][b]?this.latestMap_[a][b]++:(this.latestMap_[a][b]=1,this.latestMapSize_++):(this.latestMap_[a]={},this.latestMap_[a][b]=1,this.latestMapSize_++);this.latestMapSize_>goog.ime.offline.UserDecoder.MAX_LATEST_SIZE&&this.updatePermantMap_()};
goog.ime.offline.UserDecoder.prototype.getCandidate=function(a){var b=this.latestMap_[a];a=this.permantMap_[a];b||(b={});a||(a={});var c="",d=0,e;for(e in b){var f=goog.ime.offline.UserDecoder.LATEST_FACTOR*b[e];a[e]&&(f+=a[e]);f>d&&(c=e,d=f)}for(e in a)f=a[e],b[e]&&(f+=goog.ime.offline.UserDecoder.LATEST_FACTOR*b[e]),f>d&&(c=e,d=f);return c};
goog.ime.offline.UserDecoder.prototype.persist=function(){if(localStorage){this.updatePermantMap_();var a=JSON.stringify(this.permantMap_);localStorage.setItem(this.getKey_(),a)}};goog.ime.offline.UserDecoder.prototype.getKey_=function(){return this.inputTool_+"_user_dictionary"};
goog.ime.offline.UserDecoder.prototype.updatePermantMap_=function(){for(var a in this.latestMap_){var b=this.latestMap_[a];if(this.permantMap_[a]){var c=this.permantMap_[a],d;for(d in b)c[d]=c[d]?c[d]+b[d]:b[d]}else this.permantMap_[a]=goog.object.clone(b)}c=new goog.ime.offline.Heap;for(a in this.permantMap_)for(d in b=this.permantMap_[a],b)c.insert(b[d],0),c.getCount()>goog.ime.offline.UserDecoder.MAX_PERMANT_SIZE&&c.remove();if(c.getCount()<goog.ime.offline.UserDecoder.MAX_PERMANT_SIZE)c.clear();
else{var e=Number(c.peekKey());c.clear();for(a in this.permantMap_){b=this.permantMap_[a];for(d in b)b[d]<e&&delete b[d];goog.object.isEmpty(b)&&delete this.permantMap_[a]}this.latestMap_={};this.latestMapSize_=0}};goog.ime.offline.EventType={CLEAR:"clear"};goog.events={};goog.events.Listenable=function(){};goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1E6*Math.random()|0);goog.events.Listenable.addImplementation=function(a){a.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=!0};goog.events.Listenable.isImplementedBy=function(a){return!(!a||!a[goog.events.Listenable.IMPLEMENTED_BY_PROP])};goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_};goog.events.Listener=function(a,b,c,d,e,f){goog.events.Listener.ENABLE_MONITORING&&(this.creationStack=Error().stack);this.listener=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.handler=f;this.key=goog.events.ListenableKey.reserveKey();this.removed=this.callOnce=!1};goog.events.Listener.ENABLE_MONITORING=!1;goog.events.Listener.prototype.markAsRemoved=function(){this.removed=!0;this.handler=this.src=this.proxy=this.listener=null};goog.userAgent={};goog.userAgent.ASSUME_IE=!1;goog.userAgent.ASSUME_GECKO=!1;goog.userAgent.ASSUME_WEBKIT=!1;goog.userAgent.ASSUME_MOBILE_WEBKIT=!1;goog.userAgent.ASSUME_OPERA=!1;goog.userAgent.ASSUME_ANY_VERSION=!1;goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;
goog.userAgent.getUserAgentString=function(){return goog.global.navigator?goog.global.navigator.userAgent:null};goog.userAgent.getNavigator=function(){return goog.global.navigator};
goog.userAgent.init_=function(){goog.userAgent.detectedOpera_=!1;goog.userAgent.detectedIe_=!1;goog.userAgent.detectedWebkit_=!1;goog.userAgent.detectedMobile_=!1;goog.userAgent.detectedGecko_=!1;var a;if(!goog.userAgent.BROWSER_KNOWN_&&(a=goog.userAgent.getUserAgentString())){var b=goog.userAgent.getNavigator();goog.userAgent.detectedOpera_=0==a.indexOf("Opera");goog.userAgent.detectedIe_=!goog.userAgent.detectedOpera_&&-1!=a.indexOf("MSIE");goog.userAgent.detectedWebkit_=!goog.userAgent.detectedOpera_&&
-1!=a.indexOf("WebKit");goog.userAgent.detectedMobile_=goog.userAgent.detectedWebkit_&&-1!=a.indexOf("Mobile");goog.userAgent.detectedGecko_=!goog.userAgent.detectedOpera_&&!goog.userAgent.detectedWebkit_&&"Gecko"==b.product}};goog.userAgent.BROWSER_KNOWN_||goog.userAgent.init_();goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.userAgent.detectedOpera_;goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.userAgent.detectedIe_;
goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.userAgent.detectedGecko_;goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.userAgent.detectedWebkit_;goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.detectedMobile_;goog.userAgent.SAFARI=goog.userAgent.WEBKIT;goog.userAgent.determinePlatform_=function(){var a=goog.userAgent.getNavigator();return a&&a.platform||""};
goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.userAgent.ASSUME_MAC=!1;goog.userAgent.ASSUME_WINDOWS=!1;goog.userAgent.ASSUME_LINUX=!1;goog.userAgent.ASSUME_X11=!1;goog.userAgent.ASSUME_ANDROID=!1;goog.userAgent.ASSUME_IPHONE=!1;goog.userAgent.ASSUME_IPAD=!1;goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD;
goog.userAgent.initPlatform_=function(){goog.userAgent.detectedMac_=goog.string.contains(goog.userAgent.PLATFORM,"Mac");goog.userAgent.detectedWindows_=goog.string.contains(goog.userAgent.PLATFORM,"Win");goog.userAgent.detectedLinux_=goog.string.contains(goog.userAgent.PLATFORM,"Linux");goog.userAgent.detectedX11_=!!goog.userAgent.getNavigator()&&goog.string.contains(goog.userAgent.getNavigator().appVersion||"","X11");var a=goog.userAgent.getUserAgentString();goog.userAgent.detectedAndroid_=!!a&&
0<=a.indexOf("Android");goog.userAgent.detectedIPhone_=!!a&&0<=a.indexOf("iPhone");goog.userAgent.detectedIPad_=!!a&&0<=a.indexOf("iPad")};goog.userAgent.PLATFORM_KNOWN_||goog.userAgent.initPlatform_();goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.userAgent.detectedMac_;goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.userAgent.detectedWindows_;
goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.detectedLinux_;goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.detectedX11_;goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.userAgent.detectedAndroid_;goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.userAgent.detectedIPhone_;
goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.userAgent.detectedIPad_;
goog.userAgent.determineVersion_=function(){var a="",b;goog.userAgent.OPERA&&goog.global.opera?(a=goog.global.opera.version,a="function"==typeof a?a():a):(goog.userAgent.GECKO?b=/rv\:([^\);]+)(\)|;)/:goog.userAgent.IE?b=/MSIE\s+([^\);]+)(\)|;)/:goog.userAgent.WEBKIT&&(b=/WebKit\/(\S+)/),b&&(a=(a=b.exec(goog.userAgent.getUserAgentString()))?a[1]:""));return goog.userAgent.IE&&(b=goog.userAgent.getDocumentMode_(),b>parseFloat(a))?String(b):a};
goog.userAgent.getDocumentMode_=function(){var a=goog.global.document;return a?a.documentMode:void 0};goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(a,b){return goog.string.compareVersions(a,b)};goog.userAgent.isVersionOrHigherCache_={};
goog.userAgent.isVersionOrHigher=function(a){return goog.userAgent.ASSUME_ANY_VERSION||goog.userAgent.isVersionOrHigherCache_[a]||(goog.userAgent.isVersionOrHigherCache_[a]=0<=goog.string.compareVersions(goog.userAgent.VERSION,a))};goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher;goog.userAgent.isDocumentModeOrHigher=function(a){return goog.userAgent.IE&&goog.userAgent.DOCUMENT_MODE>=a};goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher;
goog.userAgent.DOCUMENT_MODE=function(){var a=goog.global.document;return a&&goog.userAgent.IE?goog.userAgent.getDocumentMode_()||("CSS1Compat"==a.compatMode?parseInt(goog.userAgent.VERSION,10):5):void 0}();goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("8")||
goog.userAgent.OPERA&&goog.userAgent.isVersionOrHigher("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("8")||goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart"in goog.global||!!(goog.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!goog.global.navigator||!goog.global.navigator.msMaxTouchPoints)};goog.debug.entryPointRegistry={};goog.debug.EntryPointMonitor=function(){};goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];goog.debug.entryPointRegistry.monitorsMayExist_=!1;goog.debug.entryPointRegistry.register=function(a){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=a;if(goog.debug.entryPointRegistry.monitorsMayExist_)for(var b=goog.debug.entryPointRegistry.monitors_,c=0;c<b.length;c++)a(goog.bind(b[c].wrap,b[c]))};
goog.debug.entryPointRegistry.monitorAll=function(a){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var b=goog.bind(a.wrap,a),c=0;c<goog.debug.entryPointRegistry.refList_.length;c++)goog.debug.entryPointRegistry.refList_[c](b);goog.debug.entryPointRegistry.monitors_.push(a)};
goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(a){var b=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(a==b[b.length-1],"Only the most recent monitor can be unwrapped.");a=goog.bind(a.unwrap,a);for(var c=0;c<goog.debug.entryPointRegistry.refList_.length;c++)goog.debug.entryPointRegistry.refList_[c](a);b.length--};goog.events.EventType={CLICK:"click",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",SELECTSTART:"selectstart",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:goog.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:goog.userAgent.IE?"focusout":"DOMFocusOut",CHANGE:"change",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",
DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONTEXTMENU:"contextmenu",DOMCONTENTLOADED:"DOMContentLoaded",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",
COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",TRANSITIONEND:goog.userAgent.WEBKIT?"webkitTransitionEnd":goog.userAgent.OPERA?"oTransitionEnd":"transitionend",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",
MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROVER:"MSPointerOver",MSPOINTEROUT:"MSPointerOut",MSPOINTERUP:"MSPointerUp",TEXTINPUT:"textinput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend"};goog.events.Event=function(a,b){this.type=a;this.currentTarget=this.target=b};goog.events.Event.prototype.disposeInternal=function(){};goog.events.Event.prototype.dispose=function(){};goog.events.Event.prototype.propagationStopped_=!1;goog.events.Event.prototype.defaultPrevented=!1;goog.events.Event.prototype.returnValue_=!0;goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0};
goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0;this.returnValue_=!1};goog.events.Event.stopPropagation=function(a){a.stopPropagation()};goog.events.Event.preventDefault=function(a){a.preventDefault()};goog.reflect={};goog.reflect.object=function(a,b){return b};goog.reflect.sinkValue=function(a){goog.reflect.sinkValue[" "](a);return a};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(a,b){try{return goog.reflect.sinkValue(a[b]),!0}catch(c){}return!1};goog.events.BrowserEvent=function(a,b){a&&this.init(a,b)};goog.inherits(goog.events.BrowserEvent,goog.events.Event);goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};goog.events.BrowserEvent.IEButtonMap=[1,4,2];goog.events.BrowserEvent.prototype.target=null;goog.events.BrowserEvent.prototype.relatedTarget=null;goog.events.BrowserEvent.prototype.offsetX=0;goog.events.BrowserEvent.prototype.offsetY=0;goog.events.BrowserEvent.prototype.clientX=0;
goog.events.BrowserEvent.prototype.clientY=0;goog.events.BrowserEvent.prototype.screenX=0;goog.events.BrowserEvent.prototype.screenY=0;goog.events.BrowserEvent.prototype.button=0;goog.events.BrowserEvent.prototype.keyCode=0;goog.events.BrowserEvent.prototype.charCode=0;goog.events.BrowserEvent.prototype.ctrlKey=!1;goog.events.BrowserEvent.prototype.altKey=!1;goog.events.BrowserEvent.prototype.shiftKey=!1;goog.events.BrowserEvent.prototype.metaKey=!1;
goog.events.BrowserEvent.prototype.platformModifierKey=!1;goog.events.BrowserEvent.prototype.event_=null;
goog.events.BrowserEvent.prototype.init=function(a,b){var c=this.type=a.type;goog.events.Event.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;d?goog.userAgent.GECKO&&(goog.reflect.canAccessProperty(d,"nodeName")||(d=null)):c==goog.events.EventType.MOUSEOVER?d=a.fromElement:c==goog.events.EventType.MOUSEOUT&&(d=a.toElement);this.relatedTarget=d;this.offsetX=goog.userAgent.WEBKIT||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=goog.userAgent.WEBKIT||void 0!==
a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.platformModifierKey=goog.userAgent.MAC?a.metaKey:a.ctrlKey;this.state=a.state;this.event_=a;a.defaultPrevented&&this.preventDefault();
delete this.propagationStopped_};goog.events.BrowserEvent.prototype.isButton=function(a){return goog.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==a:"click"==this.type?a==goog.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&goog.events.BrowserEvent.IEButtonMap[a])};goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)};
goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0};
goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var a=this.event_;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.BrowserEvent.prototype.disposeInternal=function(){};goog.events.listeners_={};goog.events.listenerTree_={};goog.events.sources_={};goog.events.onString_="on";goog.events.onStringMap_={};goog.events.keySeparator_="_";goog.events.listen=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.listen(a,b[f],c,d,e);return null}c=goog.events.wrapListener_(c);return goog.events.Listenable.isImplementedBy(a)?a.listen(b,c,d,e):goog.events.listen_(a,b,c,!1,d,e)};
goog.events.listen_=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");e=!!e;var g=goog.events.listenerTree_;b in g||(g[b]={count_:0,remaining_:0});g=g[b];e in g||(g[e]={count_:0,remaining_:0},g.count_++);var g=g[e],h=goog.getUid(a),k;g.remaining_++;if(g[h]){k=g[h];for(var l=0;l<k.length;l++)if(g=k[l],g.listener==c&&g.handler==f){if(g.removed)break;d||(k[l].callOnce=!1);return k[l]}}else k=g[h]=[],g.count_++;l=goog.events.getProxy();g=new goog.events.Listener(c,l,a,b,e,f);g.callOnce=d;
l.src=a;l.listener=g;k.push(g);goog.events.sources_[h]||(goog.events.sources_[h]=[]);goog.events.sources_[h].push(g);a.addEventListener?a.addEventListener(b,l,e):a.attachEvent(goog.events.getOnString_(b),l);return goog.events.listeners_[g.key]=g};goog.events.getProxy=function(){var a=goog.events.handleBrowserEvent_,b=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b};
goog.events.listenOnce=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.listenOnce(a,b[f],c,d,e);return null}c=goog.events.wrapListener_(c);return goog.events.Listenable.isImplementedBy(a)?a.listenOnce(b,c,d,e):goog.events.listen_(a,b,c,!0,d,e)};goog.events.listenWithWrapper=function(a,b,c,d,e){b.listen(a,c,d,e)};
goog.events.unlisten=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.unlisten(a,b[f],c,d,e);return null}c=goog.events.wrapListener_(c);if(goog.events.Listenable.isImplementedBy(a))return a.unlisten(b,c,d,e);d=!!d;a=goog.events.getListeners_(a,b,d);if(!a)return!1;for(f=0;f<a.length;f++)if(a[f].listener==c&&a[f].capture==d&&a[f].handler==e)return goog.events.unlistenByKey(a[f]);return!1};
goog.events.unlistenByKey=function(a){if(goog.isNumber(a)||!a||a.removed)return!1;var b=a.src;if(goog.events.Listenable.isImplementedBy(b))return b.unlistenByKey(a);var c=a.type,d=a.proxy,e=a.capture;b.removeEventListener?b.removeEventListener(c,d,e):b.detachEvent&&b.detachEvent(goog.events.getOnString_(c),d);b=goog.getUid(b);goog.events.sources_[b]&&(d=goog.events.sources_[b],goog.array.remove(d,a),0==d.length&&delete goog.events.sources_[b]);a.markAsRemoved();if(d=goog.events.listenerTree_[c][e][b])d.needsCleanup_=
!0,goog.events.cleanUp_(c,e,b,d);delete goog.events.listeners_[a.key];return!0};goog.events.unlistenWithWrapper=function(a,b,c,d,e){b.unlisten(a,c,d,e)};goog.events.cleanUp=function(a){delete goog.events.listeners_[a.key]};
goog.events.cleanUp_=function(a,b,c,d){if(!d.locked_&&d.needsCleanup_){for(var e=0,f=0;e<d.length;e++)d[e].removed||(e!=f&&(d[f]=d[e]),f++);d.length=f;d.needsCleanup_=!1;0==f&&(delete goog.events.listenerTree_[a][b][c],goog.events.listenerTree_[a][b].count_--,0==goog.events.listenerTree_[a][b].count_&&(delete goog.events.listenerTree_[a][b],goog.events.listenerTree_[a].count_--),0==goog.events.listenerTree_[a].count_&&delete goog.events.listenerTree_[a])}};
goog.events.removeAll=function(a,b){var c=0,d=null==b;if(null!=a){if(a&&goog.events.Listenable.isImplementedBy(a))return a.removeAllListeners(b);var e=goog.getUid(a);if(goog.events.sources_[e])for(var e=goog.events.sources_[e],f=e.length-1;0<=f;f--){var g=e[f];if(d||b==g.type)goog.events.unlistenByKey(g),c++}}else goog.object.forEach(goog.events.listeners_,function(a){goog.events.unlistenByKey(a);c++});return c};
goog.events.removeAllNativeListeners=function(){var a=0;goog.object.forEach(goog.events.listeners_,function(b){goog.events.Listenable.isImplementedBy(b.src)||(goog.events.unlistenByKey(b),a++)});return a};goog.events.getListeners=function(a,b,c){return goog.events.Listenable.isImplementedBy(a)?a.getListeners(b,c):goog.events.getListeners_(a,b,c)||[]};goog.events.getListeners_=function(a,b,c){var d=goog.events.listenerTree_;return b in d&&(d=d[b],c in d&&(d=d[c],a=goog.getUid(a),d[a]))?d[a]:null};
goog.events.getListener=function(a,b,c,d,e){d=!!d;c=goog.events.wrapListener_(c);if(goog.events.Listenable.isImplementedBy(a))return a.getListener(b,c,d,e);if(a=goog.events.getListeners_(a,b,d))for(b=0;b<a.length;b++)if(!a[b].removed&&a[b].listener==c&&a[b].capture==d&&a[b].handler==e)return a[b];return null};
goog.events.hasListener=function(a,b,c){if(goog.events.Listenable.isImplementedBy(a))return a.hasListener(b,c);a=goog.getUid(a);var d=goog.events.sources_[a];if(d){var e=goog.isDef(b),f=goog.isDef(c);return e&&f?(d=goog.events.listenerTree_[b],!!d&&!!d[c]&&a in d[c]):e||f?goog.array.some(d,function(a){return e&&a.type==b||f&&a.capture==c}):!0}return!1};goog.events.expose=function(a){var b=[],c;for(c in a)a[c]&&a[c].id?b.push(c+" = "+a[c]+" ("+a[c].id+")"):b.push(c+" = "+a[c]);return b.join("\n")};
goog.events.getOnString_=function(a){return a in goog.events.onStringMap_?goog.events.onStringMap_[a]:goog.events.onStringMap_[a]=goog.events.onString_+a};goog.events.fireListeners=function(a,b,c,d){if(goog.events.Listenable.isImplementedBy(a))return a.fireListeners(b,c,d);var e=goog.events.listenerTree_;return b in e&&(e=e[b],c in e)?goog.events.fireListeners_(e[c],a,b,c,d):!0};
goog.events.fireListeners_=function(a,b,c,d,e){var f=1;b=goog.getUid(b);if(a[b]){var g=--a.remaining_,h=a[b];h.locked_?h.locked_++:h.locked_=1;try{for(var k=h.length,l=0;l<k;l++){var n=h[l];n&&!n.removed&&(f&=!1!==goog.events.fireListener(n,e))}}finally{a.remaining_=Math.max(g,a.remaining_),h.locked_--,goog.events.cleanUp_(c,d,b,h)}}return Boolean(f)};goog.events.fireListener=function(a,b){var c=a.listener,d=a.handler||a.src;a.callOnce&&goog.events.unlistenByKey(a);return c.call(d,b)};
goog.events.getTotalListenerCount=function(){return goog.object.getCount(goog.events.listeners_)};goog.events.dispatchEvent=function(a,b){goog.asserts.assert(goog.events.Listenable.isImplementedBy(a),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance.");return a.dispatchEvent(b)};goog.events.protectBrowserEventEntryPoint=function(a){goog.events.handleBrowserEvent_=a.protectEntryPoint(goog.events.handleBrowserEvent_)};
goog.events.handleBrowserEvent_=function(a,b){if(a.removed)return!0;var c=a.type,d=goog.events.listenerTree_;if(!(c in d))return!0;var d=d[c],e,f;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){e=b||goog.getObjectByName("window.event");var g=!0 in d,h=!1 in d;if(g){if(goog.events.isMarkedIeEvent_(e))return!0;goog.events.markIeEvent_(e)}var k=new goog.events.BrowserEvent;k.init(e,this);e=!0;try{if(g){for(var l=[],n=k.currentTarget;n;n=n.parentNode)l.push(n);f=d[!0];f.remaining_=f.count_;for(var m=
l.length-1;!k.propagationStopped_&&0<=m&&f.remaining_;m--)k.currentTarget=l[m],e&=goog.events.fireListeners_(f,l[m],c,!0,k);if(h)for(f=d[!1],f.remaining_=f.count_,m=0;!k.propagationStopped_&&m<l.length&&f.remaining_;m++)k.currentTarget=l[m],e&=goog.events.fireListeners_(f,l[m],c,!1,k)}else e=goog.events.fireListener(a,k)}finally{l&&(l.length=0)}return e}c=new goog.events.BrowserEvent(b,this);return e=goog.events.fireListener(a,c)};
goog.events.markIeEvent_=function(a){var b=!1;if(0==a.keyCode)try{a.keyCode=-1;return}catch(c){b=!0}if(b||void 0==a.returnValue)a.returnValue=!0};goog.events.isMarkedIeEvent_=function(a){return 0>a.keyCode||void 0!=a.returnValue};goog.events.uniqueIdCounter_=0;goog.events.getUniqueId=function(a){return a+"_"+goog.events.uniqueIdCounter_++};goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1E9*Math.random()>>>0);
goog.events.wrapListener_=function(a){goog.asserts.assert(a,"Listener can not be null.");if(goog.isFunction(a))return a;goog.asserts.assert(a.handleEvent,"An object listener must have handleEvent method.");return a[goog.events.LISTENER_WRAPPER_PROP_]||(a[goog.events.LISTENER_WRAPPER_PROP_]=function(b){return a.handleEvent(b)})};goog.debug.entryPointRegistry.register(function(a){goog.events.handleBrowserEvent_=a(goog.events.handleBrowserEvent_)});goog.events.EventTarget=function(){goog.Disposable.call(this);this.eventTargetListeners_={};this.actualEventTarget_=this};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.Listenable.addImplementation(goog.events.EventTarget);goog.events.EventTarget.MAX_ANCESTORS_=1E3;goog.events.EventTarget.prototype.parentEventTarget_=null;goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};
goog.events.EventTarget.prototype.setParentEventTarget=function(a){this.parentEventTarget_=a};goog.events.EventTarget.prototype.addEventListener=function(a,b,c,d){goog.events.listen(this,a,b,c,d)};goog.events.EventTarget.prototype.removeEventListener=function(a,b,c,d){goog.events.unlisten(this,a,b,c,d)};
goog.events.EventTarget.prototype.dispatchEvent=function(a){this.assertInitialized_();var b,c=this.getParentEventTarget();if(c){b=[];for(var d=1;c;c=c.getParentEventTarget())b.push(c),goog.asserts.assert(++d<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop")}return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,a,b)};
goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);this.removeAllListeners();this.parentEventTarget_=null};goog.events.EventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call superclass (goog.events.EventTarget) constructor?")};goog.events.EventTarget.prototype.listen=function(a,b,c,d){return this.listenInternal_(a,b,!1,c,d)};
goog.events.EventTarget.prototype.listenOnce=function(a,b,c,d){return this.listenInternal_(a,b,!0,c,d)};goog.events.EventTarget.prototype.listenInternal_=function(a,b,c,d,e){this.assertInitialized_();var f=this.eventTargetListeners_[a]||(this.eventTargetListeners_[a]=[]),g=goog.events.EventTarget.findListenerIndex_(f,b,d,e);if(-1<g)return a=f[g],c||(a.callOnce=!1),a;a=new goog.events.Listener(b,null,this,a,!!d,e);a.callOnce=c;f.push(a);return a};
goog.events.EventTarget.prototype.unlisten=function(a,b,c,d){if(!(a in this.eventTargetListeners_))return!1;a=this.eventTargetListeners_[a];b=goog.events.EventTarget.findListenerIndex_(a,b,c,d);return-1<b?(c=a[b],goog.events.cleanUp(c),c.removed=!0,goog.array.removeAt(a,b)):!1};goog.events.EventTarget.prototype.unlistenByKey=function(a){var b=a.type;if(!(b in this.eventTargetListeners_))return!1;if(b=goog.array.remove(this.eventTargetListeners_[b],a))goog.events.cleanUp(a),a.removed=!0;return b};
goog.events.EventTarget.prototype.removeAllListeners=function(a,b){var c=0,d;for(d in this.eventTargetListeners_)if(!a||d==a){for(var e=this.eventTargetListeners_[d],f=0;f<e.length;f++)++c,goog.events.cleanUp(e[f]),e[f].removed=!0;e.length=0}return c};
goog.events.EventTarget.prototype.fireListeners=function(a,b,c){if(!(a in this.eventTargetListeners_))return!0;var d=!0;a=goog.array.clone(this.eventTargetListeners_[a]);for(var e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==b){var g=f.listener,h=f.handler||f.src;f.callOnce&&this.unlistenByKey(f);d=!1!==g.call(h,c)&&d}}return d&&!1!=c.returnValue_};
goog.events.EventTarget.prototype.getListeners=function(a,b){var c=this.eventTargetListeners_[a],d=[];if(c)for(var e=0;e<c.length;++e){var f=c[e];f.capture==b&&d.push(f)}return d};goog.events.EventTarget.prototype.getListener=function(a,b,c,d){a=this.eventTargetListeners_[a];var e=-1;a&&(e=goog.events.EventTarget.findListenerIndex_(a,b,c,d));return-1<e?a[e]:null};
goog.events.EventTarget.prototype.hasListener=function(a,b){var c=goog.isDef(a),d=goog.isDef(b);return goog.object.some(this.eventTargetListeners_,function(e,f){for(var g=0;g<e.length;++g)if(!(c&&e[g].type!=a||d&&e[g].capture!=b))return!0;return!1})};goog.events.EventTarget.prototype.setTargetForTesting=function(a){this.actualEventTarget_=a};
goog.events.EventTarget.dispatchEventInternal_=function(a,b,c){var d=b.type||b;if(goog.isString(b))b=new goog.events.Event(b,a);else if(b instanceof goog.events.Event)b.target=b.target||a;else{var e=b;b=new goog.events.Event(d,a);goog.object.extend(b,e)}var e=!0,f;if(c)for(var g=c.length-1;!b.propagationStopped_&&0<=g;g--)f=b.currentTarget=c[g],e=f.fireListeners(d,!0,b)&&e;b.propagationStopped_||(f=b.currentTarget=a,e=f.fireListeners(d,!0,b)&&e,b.propagationStopped_||(e=f.fireListeners(d,!1,b)&&e));
if(c)for(g=0;!b.propagationStopped_&&g<c.length;g++)f=b.currentTarget=c[g],e=f.fireListeners(d,!1,b)&&e;return e};goog.events.EventTarget.findListenerIndex_=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(f.listener==b&&f.capture==!!c&&f.handler==d)return e}return-1};goog.ime.offline.DataLoader=function(a){this.inputTool=a;this.initialTokens="";this.dataReady=!1};goog.inherits(goog.ime.offline.DataLoader,goog.Disposable);goog.ime.offline.DataLoader.PARAMS={INPUT_TOOL:"chosInputTool",SOURCE_MAP:"sourceMap",TARGET_MAP:"targetMap",DEFAULT_PROB:"defaultProb",SOURCE_SEGS:"sourceSegments",TARGET_SEGS:"targetSegments",SOURCE_PROS:"sourceProbs",TARGET_PROS:"targetProbs",TARGET_POS:"targetPositions",TOKENS:"chosTokens"};
goog.ime.offline.DataLoader.prototype.loadModelData=function(a){this.dataReady?a():window[goog.ime.offline.DataLoader.PARAMS.INPUT_TOOL]==this.inputTool&&(this.loadModelDataInternal_(),this.dataReady=!0,a())};
goog.ime.offline.DataLoader.prototype.loadModelDataInternal_=function(){var a=goog.ime.offline.DataLoader.PARAMS;this.sourceMap=window[a.SOURCE_MAP];this.targetMap=window[a.TARGET_MAP];this.defaultProb=window[a.DEFAULT_PROB];this.tokens=window[a.TOKENS];this.sourceSegments=window[a.SOURCE_SEGS];this.targetSegments=window[a.TARGET_SEGS];this.targetProbs=window[a.TARGET_PROS];this.targetPositions=window[a.TARGET_POS];this.buildTokens_();this.dataReady=!0};
goog.ime.offline.DataLoader.prototype.buildTokens_=function(){var a=goog.ime.offline.InputToolCode;if(this.inputTool==a.INPUTMETHOD_ZHUYIN_CHINESE_TRADITIONAL){for(var b=[],c=this.tokens.split("|"),a=0;a<c.length;++a){var d=c[a].slice(0,c[a].length-1);0>b.indexOf(d)&&b.push(d)}this.untoneTokens=b.join("|");b=[];for(a=12549;12569>=a;++a)b.push(String.fromCharCode(a));this.initialTokens=b.join("|")}else if(this.inputTool==a.INPUTMETHOD_PINYIN_CHINESE_SIMPLIFIED||this.inputTool==a.INPUTMETHOD_PINYIN_CHINESE_TRADITIONAL)this.initialTokens=
"b|p|m|f|d|t|n|l|k|g|h|j|q|x|zh|ch|sh|r|z|c|s|y|w"};goog.ime.offline.DataLoader.prototype.getDirectory_=function(a){var b=goog.ime.offline.InputToolCode;switch(a){case b.INPUTMETHOD_PINYIN_CHINESE_SIMPLIFIED:return"pinyin/";case b.INPUTMETHOD_ZHUYIN_CHINESE_TRADITIONAL:return"zhuyin/"}return""};goog.ime.offline.LatticeNode=function(){this.initNum=0;this.edges=[]};goog.ime.offline.TokenPath=function(a,b){this.tokens=a;this.separators=b};
goog.ime.offline.TokenDecoder=function(a,b,c){goog.events.EventTarget.call(this);this.inputTool_=a;this.dataLoader_=b||new goog.ime.offline.DataLoader(a);this.fuzzyMap_=null;this.tokenReg_=/xyz/g;this.tones_="\u02c9\u02ca\u02c7\u02cb\u02d9";this.initialMap_={};this.currentStr_="";this.separators_=[];this.separatorChar_="'";this.lattice_=[];this.dataLoader_.loadModelData(goog.bind(this.init_,this,c))};goog.inherits(goog.ime.offline.TokenDecoder,goog.events.EventTarget);
goog.ime.offline.TokenDecoder.prototype.init_=function(a){var b=this.dataLoader_.tokens,c=this.dataLoader_.untoneTokens,d=this.dataLoader_.initialTokens;this.tokenReg_=c?RegExp("^("+b+"|"+c+"|"+d+")$"):RegExp("^("+b+"|"+d+")$");d=d.split("|");for(c=0;c<d.length;c++)this.initialMap_[d[c]]=[];b=b.split("|");for(c=0;c<b.length;c++)for(var d=b[c],e=1;2>=e;++e){var f=d.slice(0,e);this.initialMap_[f]&&1<d.length&&this.initialMap_[f].push(d)}a&&this.updateFuzzyPairs(a);this.clear()};
goog.ime.offline.TokenDecoder.prototype.updateFuzzyPairs=function(a){this.fuzzyMap_={};for(var b=0;b<a.length;++b)for(var c=a[b].split("_"),d=0;2>d;++d)this.fuzzyMap_[c[d]]||(this.fuzzyMap_[c[d]]=[]),this.fuzzyMap_[c[d]].push(c[1-d])};goog.ime.offline.TokenDecoder.prototype.isAllInitials=function(a){for(var b=0;b<a.length;++b)if(!this.initialMap_[a[b]])return!1;return!0};
goog.ime.offline.TokenDecoder.prototype.getNormalizedTokens=function(a){for(var b=[],c=0;c<a.length;++c)b.push(this.getNormalizedToken(a[c]));return b};
goog.ime.offline.TokenDecoder.prototype.getNormalizedToken=function(a){var b=[a],c=RegExp("["+this.tones_+"]");if(this.initialMap_[a])b=b.concat(goog.array.clone(this.initialMap_[a]));else if(this.dataLoader_.untoneTokens&&!a.slice(-1).match(c))for(c=0;c<this.tones_.length;++c)b.push(a+this.tones_[c]);if(this.fuzzyMap_)for(var d in this.fuzzyMap_)if(a.match(d)){1==b.length&&b.push(a);for(var e=this.fuzzyMap_[d],c=0;c<e.length;++c)b.push(a.replace(d,e[c]))}return b};
goog.ime.offline.TokenDecoder.prototype.getTokens=function(a){var b=this.getOriginalStr_();0==a.indexOf(b)&&this.append_(a.slice(b.length));if(b=this.getRange_(a)){for(var c=this.getPaths_(b.start,b.end),d=[],e=0;e<c.length;++e){for(var f=c[e],g=[],h=[],k=b.start,l=0;l<f.length;++l)g.push(this.currentStr_.slice(k,f[l])),h.push(0<=this.separators_.indexOf(f[l])),k=f[l];d.push(new goog.ime.offline.TokenPath(g,h))}return 0==d.length?this.getTokens(a.slice(0,-1)):d}this.dispatchEvent(goog.ime.offline.EventType.CLEAR);
return this.getTokens(a)};
goog.ime.offline.TokenDecoder.prototype.getBestTokens=function(a){a=this.getTokens(a);if(0==a.length)return null;if(1==a.length)return a[0];var b=goog.array.reduce(a,function(a,b){return Math.min(a,b.tokens.length)},Infinity);a=goog.array.filter(a,function(a){return a.tokens.length<=b});if(1==a.length)return a[0];var c=/[aeiou]/,d=[],e=goog.array.reduce(a,function(a,b,e){b=goog.array.reduce(b.tokens,function(a,b){return b.slice(0,1).match(c)?a+1:a},0);d[e]=b;return Math.min(a,b)},Infinity),e=d.indexOf(e);
return a[e]};goog.ime.offline.TokenDecoder.prototype.getOriginalTokens=function(a){var b=a.separators;a=goog.array.clone(a.tokens);for(var c=0;c<a.length;++c)b[c]&&(a[c]+=this.separatorChar_);return a};goog.ime.offline.TokenDecoder.prototype.clear=function(){this.currentStr_="";this.separators_=[];this.lattice_=[];this.lattice_[0]={};this.lattice_[0].initNum=0};
goog.ime.offline.TokenDecoder.prototype.append_=function(a){for(var b=0;b<a.length;++b){var c=a.slice(b,b+1),d=this.currentStr_.length;if(c==this.separatorChar_)this.separators_.push(d);else{this.currentStr_+=c;d++;var c=this.getSuffixTokens_(this.currentStr_),e=[],f=goog.array.reduce(c,function(a,b,c){if(!this.inSameRange_(d-b.length,d))return e[c]=Infinity,a;var f=this.lattice_[d-b.length].initNum;e[c]=this.initialMap_[b]?f+1:f;return Math.min(a,e[c])},Infinity,this);if(Infinity!=f){this.lattice_[d]=
new goog.ime.offline.LatticeNode;this.lattice_[d].initNum=f;this.lattice_[d].edges=[];for(var g=0;g<c.length;++g){var h=c[g];e[g]>f||this.lattice_[d].edges.push(d-h.length)}}}}};goog.ime.offline.TokenDecoder.prototype.getPathsFrom_=function(a,b){for(var c=[],d=a+1;d<=b;++d)for(var e=this.lattice_[d].edges,f=0;f<e.length;++f)if(e[f]==a){c.push([d]);e=goog.array.clone(this.getPathsFrom_(d,b));for(f=0;f<e.length;++f)c.push([d].concat(e[f]));break}return c};
goog.ime.offline.TokenDecoder.prototype.getPaths_=function(a,b){if(!this.lattice_[b]||!this.lattice_[b].edges)return[];for(var c=[],d=this.lattice_[b].edges,e=0;e<d.length;++e)if(!(d[e]<a))if(d[e]==a)c.push([b]);else for(var f=goog.array.clone(this.getPaths_(a,d[e])),g=0;g<f.length;++g)f[g].push(b),c.push(f[g]);return c};
goog.ime.offline.TokenDecoder.prototype.getOriginalStr_=function(){for(var a="",b=0,c=0;c<this.separators_.length;++c)b=this.currentStr_.slice(b,this.separators_[c]),a+=b+this.separatorChar_,b=this.separators_[c];return a+=this.currentStr_.slice(b)};
goog.ime.offline.TokenDecoder.prototype.getRange_=function(a){var b=this.getOriginalStr_(),c=b.indexOf(a);if(0>c)return null;a=c+a.length;var d=b.slice(0,c).split(this.separatorChar_).length-1,b=b.slice(0,a).split(this.separatorChar_).length-1,e={};e.start=c-d;e.end=a-b;return e};
goog.ime.offline.TokenDecoder.prototype.inSameRange_=function(a,b){var c=goog.array.binarySearch(this.separators_,a),d=goog.array.binarySearch(this.separators_,b);return c==d||0<=c&&-2==c+d||0<=d&&-1==c+d||0<=c&&0<=d&&d==c+1?!0:!1};goog.ime.offline.TokenDecoder.prototype.getSuffixTokens_=function(a){for(var b=[],c=1;5>=c&&c<=a.length;++c){var d=this.currentStr_.slice(-c);d.match(this.tokenReg_)&&b.push(d)}return b};goog.events.EventHandler=function(a){goog.Disposable.call(this);this.handler_=a;this.keys_={}};goog.inherits(goog.events.EventHandler,goog.Disposable);goog.events.EventHandler.typeArray_=[];goog.events.EventHandler.prototype.listen=function(a,b,c,d,e){goog.isArray(b)||(goog.events.EventHandler.typeArray_[0]=b,b=goog.events.EventHandler.typeArray_);for(var f=0;f<b.length;f++){var g=goog.events.listen(a,b[f],c||this,d||!1,e||this.handler_||this);if(goog.DEBUG&&!g)break;this.keys_[g.key]=g}return this};
goog.events.EventHandler.prototype.listenOnce=function(a,b,c,d,e){if(goog.isArray(b))for(var f=0;f<b.length;f++)this.listenOnce(a,b[f],c,d,e);else a=goog.events.listenOnce(a,b,c||this,d,e||this.handler_||this),this.keys_[a.key]=a;return this};goog.events.EventHandler.prototype.listenWithWrapper=function(a,b,c,d,e){b.listen(a,c,d,e||this.handler_||this,this);return this};
goog.events.EventHandler.prototype.getListenerCount=function(){var a=0,b;for(b in this.keys_)Object.prototype.hasOwnProperty.call(this.keys_,b)&&a++;return a};goog.events.EventHandler.prototype.unlisten=function(a,b,c,d,e){if(goog.isArray(b))for(var f=0;f<b.length;f++)this.unlisten(a,b[f],c,d,e);else if(a=goog.events.getListener(a,b,c||this,d,e||this.handler_||this))goog.events.unlistenByKey(a),delete this.keys_[a.key];return this};
goog.events.EventHandler.prototype.unlistenWithWrapper=function(a,b,c,d,e){b.unlisten(a,c,d,e||this.handler_||this,this);return this};goog.events.EventHandler.prototype.removeAll=function(){goog.object.forEach(this.keys_,goog.events.unlistenByKey);this.keys_={}};goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this);this.removeAll()};
goog.events.EventHandler.prototype.handleEvent=function(a){throw Error("EventHandler.handleEvent not implemented");};goog.ime.offline.Long=function(a,b){this.low_=a|0;this.high_=b|0};goog.ime.offline.Long.TWO_PWR_32_DBL_=4294967296;goog.ime.offline.Long.fromInt=function(a){return new goog.ime.offline.Long(a,0)};goog.ime.offline.Long.prototype.or=function(a){return new goog.ime.offline.Long(this.low_|a.low_,this.high_|a.high_)};
goog.ime.offline.Long.prototype.shiftLeft=function(a){var b=this;a&=63;0==a?b=this:(b=this.low_,b=32>a?new goog.ime.offline.Long(b<<a,(this.high_<<a)+(b>>>32-a)):new goog.ime.offline.Long(0,b<<a-32));return b};goog.ime.offline.Long.prototype.toNumber=function(){return this.high_*goog.ime.offline.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()};goog.ime.offline.Long.prototype.getLowBitsUnsigned=function(){return 0<=this.low_?this.low_:goog.ime.offline.Long.TWO_PWR_32_DBL_+this.low_};
goog.ime.offline.Target=function(a,b){this.segment=a;this.prob=b};goog.ime.offline.DataParser=function(a,b){this.inputTool_=a;this.dataLoader=b;this.targetMap=this.sourceMap=null;this.sourceSegments_=[];this.targetOffsets_=[];this.targetSegments_=[];this.targetProbs_=[];this.defaultProb_=1;this.maxTokenSize_=300;this.ready=!1;this.dataLoader.loadModelData(goog.bind(this.loadComplete_,this))};
goog.ime.offline.DataParser.prototype.loadComplete_=function(){var a=this.dataLoader;this.sourceSegments_=a.sourceSegments;this.targetSegments_=a.targetSegments;this.targetProbs_=a.targetProbs;this.targetOffsets_=a.targetPositions;this.sourceMap=a.sourceMap;this.targetMap=a.targetMap;this.defaultProb_=Number(a.defaultProb);this.ready_=!0};goog.ime.offline.DataParser.prototype.normalizeProb=function(a){return void 0==a?1:a/this.defaultProb_};
goog.ime.offline.DataParser.prototype.getSourcePos=function(a){a=this.encodeUnicodeString(a);return goog.array.binarySearch(this.sourceSegments_,a,this.compareFn)};goog.ime.offline.DataParser.prototype.getTargetPos=function(a){var b={};a=this.getSourcePos(a);if(0>a)return b.start=0,b.end=-1,b;var c=a<this.targetOffsets_.length-1?this.targetOffsets_[a+1]:this.targetSegments_.length;b.start=this.targetOffsets_[a];b.end=c;return b};
goog.ime.offline.DataParser.prototype.getTargetMappings=function(a,b){for(var c=this.getTokenSequeces(a,b),d=[],e=0;e<c.length;++e){for(var f=this.targetSegments_,g=this.targetProbs_,h=this.getTargetPos(c[e]),k=h.start,h=h.end,l=k;l<h;l++){var n=this.decodeUnicodeString(f[l]),n=new goog.ime.offline.Target(n,this.normalizeProb(g[l]));d.push(n)}if(b&&0==e&&k<h)break}return d};
goog.ime.offline.DataParser.prototype.encodeUnicodeString=function(a){for(var b=this.sourceMap,c=[],d=goog.ime.offline.Long.fromInt(0),e=goog.ime.offline.Long.fromInt(1),f=0,g=a.length,h=0;h<g;h++){var k=a[h];if(!goog.object.containsKey(b,k))return 0;var l=goog.ime.offline.Long.fromInt(Number(b[k][0])),k=Number(b[k][1]);63<=f+k?(d=d.or(e.shiftLeft(f)),c.unshift(d.toNumber()),d=l,f=k):(d=d.or(l.shiftLeft(f)),f+=k)}0<f&&(d=d.or(e.shiftLeft(f)),c.unshift(d.toNumber()));return 1==c.length?c[0]:c};
goog.ime.offline.DataParser.prototype.decodeUnicodeString=function(a){var b=this.targetMap;if(goog.isArray(a)){for(var c="",b=0;b<a.length;b++)c=this.decodeUnicodeString(a[b])+c;return c}for(var c="",d=b;1!=a;){var e=a%2;a=(a-e)/2;d=d[e];goog.isArray(d)||(c+=d,d=b)}return c};
goog.ime.offline.DataParser.prototype.getTokenSequeces=function(a,b){for(var c=1,d=0;d<a.length;++d)c*=a[d].length;for(var e=[],d=0;d<a.length;++d)e.push(a[d][0]);if(1==c||c>this.maxTokenSize_)return[e];c=[[]];for(d=0;d<a.length;d++)for(var f=c.length,g=0;g<f;g++)for(var h=c.shift(),k=1<a[d].length?1:0;k<a[d].length;k++)c.push(h.concat(a[d][k]));return b?[e].concat(c):c};
goog.ime.offline.DataParser.prototype.compareFn=function(a,b){return goog.isArray(a)&&goog.isArray(b)?a.length==b.length?goog.array.compare3(a,b):a.length-b.length:goog.isArray(a)?1:goog.isArray(b)?-1:a-b};goog.ime.offline.MLDecoder=function(a,b){this.inputTool_=a;this.dataLoader_=b||new goog.ime.offline.DataLoader(a);this.parser_=new goog.ime.offline.DataParser(a,this.dataLoader_);this.subTranslitCache_={};this.preTranslitCache_={};this.pruneNum_=1};goog.ime.offline.MLDecoder.MAX_SOURCE_LENGTH=20;goog.ime.offline.MLDecoder.DEFAULT_RESULTS_NUM=50;goog.ime.offline.MLDecoder.MULTI_SEGMENT_FACTOR=-0.7;
goog.ime.offline.MLDecoder.prototype.transliterate=function(a,b,c){if(a.length>goog.ime.offline.MLDecoder.MAX_SOURCE_LENGTH)return[];0>b&&(b=goog.ime.offline.MLDecoder.DEFAULT_RESULTS_NUM);var d=this.generateTransliterations_(a,c);c=this.generatePrefixTransliterations_(a,b,c);return this.rankTransliterations_(a,b,d,c)};
goog.ime.offline.MLDecoder.prototype.generateTransliterations_=function(a,b){if(this.subTranslitCache_[this.getKey_(a)])return this.subTranslitCache_[this.getKey_(a)];var c=new goog.ime.offline.Heap,d=this.parser_.getTargetMappings(a,b);this.updateScoresForTargets_(d,c,1);for(d=a.length-1;0<d;d--){var e=a.slice(0,d),f=a.slice(d),g=new goog.ime.offline.Heap,h=new goog.ime.offline.Heap,g=this.parser_.getTargetMappings(f,b);this.updateScoresForTargets_(g,h,1);if(0!=h.getCount())for(var g=this.subTranslitCache_[this.getKey_(e)]?
this.subTranslitCache_[this.getKey_(e)]:this.generateTransliterations_(e),e=g.getValues(),g=g.getKeys(),f=h.getValues(),h=h.getKeys(),k=0;k<g.length;++k)for(var l=Number(g[k]),n=e[k],m=0;m<h.length;++m)c.increase(l+Number(h[m])+goog.ime.offline.MLDecoder.MULTI_SEGMENT_FACTOR,n+f[m]),c.getCount()>this.pruneNum_&&c.remove()}return this.subTranslitCache_[this.getKey_(a)]=c};
goog.ime.offline.MLDecoder.prototype.generatePrefixTransliterations_=function(a,b,c){if(this.preTranslitCache_[this.getKey_(a)])return this.preTranslitCache_[this.getKey_(a)];for(var d=new goog.ime.offline.Heap,e=a.length,f=1;f<=e;f++){var g=a.slice(0,f);if(this.preTranslitCache_[this.getKey_(g)])d.clear(),d.insertAll(this.preTranslitCache_[this.getKey_(g)]);else{for(var h=this.parser_.getTargetMappings(g,c),k=0;k<h.length;++k){var l=h[k],l=new goog.ime.offline.Candidate(g.length,l.segment,l.prob);
d.insert(l.score,l)}d.getCount()>b&&d.remove();this.preTranslitCache_[this.getKey_(g)]=d}}return d};goog.ime.offline.MLDecoder.prototype.updateScoresForTargets_=function(a,b,c){for(c=0;c<a.length;++c)b.increase(a[c].prob,a[c].segment),b.getCount()>this.pruneNum_&&b.remove()};
goog.ime.offline.MLDecoder.prototype.rankTransliterations_=function(a,b,c,d){b=[];c=c.clone();for(d=d.clone();1<c.getCount()&&0<d.getCount();){var e;if(c.peekKey()<d.peekKey()){e=Number(c.peekKey());var f=c.remove().toString();e=new goog.ime.offline.Candidate(a.length,f,e)}else e=d.remove();b.unshift(e)}for(;0<d.getCount();)b.unshift(d.remove());for(;0<c.getCount();)e=Number(c.peekKey()),f=c.remove().toString(),e=new goog.ime.offline.Candidate(a.length,f,e),b.unshift(e);return b};
goog.ime.offline.MLDecoder.prototype.clear=function(){for(var a in this.subTranslitCache_)this.subTranslitCache_[a].clear();this.subTranslitCache_={};for(a in this.preTranslitCache_)this.preTranslitCache_[a].clear();this.preTranslitCache_={}};goog.ime.offline.MLDecoder.prototype.getKey_=function(a){for(var b="",c=0;c<a.length;++c)b+=a[c][0];return b};goog.ime.offline.Response=function(a,b){this.tokens=a;this.candidates=b};
goog.ime.offline.Decoder=function(a,b,c,d){this.inputTool_=a;this.readyCallback_=b||null;this.dataLoader_=new goog.ime.offline.DataLoader(a);this.dataLoader_.loadModelData(goog.bind(this.onDecoderReady_,this));this.tokenDecoder_=new goog.ime.offline.TokenDecoder(a,this.dataLoader_,c);this.mlDecoder_=new goog.ime.offline.MLDecoder(a,this.dataLoader_);this.userDecoder_=d?new goog.ime.offline.UserDecoder(a):null;this.eventHandler_=new goog.events.EventHandler(this);this.eventHandler_.listen(this.tokenDecoder_,
goog.ime.offline.EventType.CLEAR,this.clear)};goog.inherits(goog.ime.offline.Decoder,goog.Disposable);goog.ime.offline.Decoder.prototype.disposeInternal=function(){this.dataLoader_.dispose()};goog.ime.offline.Decoder.prototype.isReady=function(){return this.dataLoader_.dataReady};
goog.ime.offline.Decoder.prototype.decode=function(a,b){if(!this.isReady()||!a)return null;var c=this.tokenDecoder_.getBestTokens(a);if(!c)return null;for(var d=this.tokenDecoder_.getNormalizedTokens(c.tokens),e=this.tokenDecoder_.isAllInitials(c.tokens),e=this.mlDecoder_.transliterate(d,b,e),d=[],f=[],g=0;g<e.length;++g){var h=e[g];if(0>f.indexOf(h.target)&&(d.push(h),f.push(h.target),d.length>=b))break}if(this.userDecoder_){var k=this.userDecoder_.getCandidate(a);k&&(e=goog.array.findIndex(d,function(a){return a.target==
k}),0<e&&goog.array.removeAt(d,e),0!=e&&(e=new goog.ime.offline.Candidate(a.length,k,0),d.splice(1,0,e)))}c=this.tokenDecoder_.getOriginalTokens(c);return new goog.ime.offline.Response(c,d)};goog.ime.offline.Decoder.prototype.onDecoderReady_=function(){this.readyCallback_&&this.readyCallback_()};goog.ime.offline.Decoder.prototype.addUserCommits=function(a,b){this.userDecoder_&&this.userDecoder_.add(a,b)};goog.ime.offline.Decoder.prototype.persist=function(){this.userDecoder_&&this.userDecoder_.persist()};
goog.ime.offline.Decoder.prototype.clear=function(){this.tokenDecoder_.clear();this.mlDecoder_.clear()};goog.ime.offline.Decoder.prototype.updateFuzzyPairs=function(a){this.tokenDecoder_.updateFuzzyPairs(a)};goog.ime.offline.Decoder.prototype.enableUserDict=function(a){a&&!this.userDecoder_&&(this.userDecoder_=new goog.ime.offline.UserDecoder(this.inputTool_));a||(this.userDecoder_=null)};goog.ime.chrome.os.Model=function(){goog.events.EventTarget.call(this);this.candidates=[];this.segments=[];this.tokens=[];this.configFactory=goog.ime.chrome.os.ConfigFactory.getInstance()};goog.inherits(goog.ime.chrome.os.Model,goog.events.EventTarget);goog.ime.chrome.os.Model.prototype.decoder_=null;goog.ime.chrome.os.Model.prototype.status=goog.ime.chrome.os.Status.INIT;goog.ime.chrome.os.Model.prototype.source="";goog.ime.chrome.os.Model.prototype.cursorPos=0;
goog.ime.chrome.os.Model.prototype.context="";goog.ime.chrome.os.Model.prototype.highlightIndex=-1;goog.ime.chrome.os.Model.prototype.commitPos=0;goog.ime.chrome.os.Model.prototype.holdSelectStatus_=!1;goog.ime.chrome.os.Model.prototype.ready=!1;goog.ime.chrome.os.Model.prototype.updateHighlight=function(a){this.status==goog.ime.chrome.os.Status.SELECT&&(0>a&&(a=0),a>=this.candidates.length||(this.highlightIndex=a,this.notifyUpdates()))};
goog.ime.chrome.os.Model.prototype.moveHighlight=function(a){this.status==goog.ime.chrome.os.Status.SELECT&&this.updateHighlight(this.highlightIndex+a)};goog.ime.chrome.os.Model.prototype.movePage=function(a){if(this.status==goog.ime.chrome.os.Status.SELECT){var b=this.configFactory.getCurrentConfig().pageSize;this.updateHighlight((this.getPageIndex()+a)*b)}};
goog.ime.chrome.os.Model.prototype.getPageIndex=function(){if(0>this.highlightIndex||0==this.candidates.length)return 0;var a=this.configFactory.getCurrentConfig().pageSize;return Math.floor(this.highlightIndex/a)};
goog.ime.chrome.os.Model.prototype.moveCursorLeft=function(){this.status!=goog.ime.chrome.os.Status.SELECT||0>=this.cursorPos||(this.cursorPos==this.commitPos?(this.commitPos--,this.segments[this.commitPos]=this.tokens[this.commitPos]):this.cursorPos--,this.source=this.segments.slice(this.commitPos,this.cursorPos).join(""),this.highlightIndex=-1,this.dispatchEvent(goog.ime.chrome.os.EventType.MODELUPDATED),this.holdSelectStatus_=!0,this.source&&this.fetchCandidates_())};
goog.ime.chrome.os.Model.prototype.moveCursorRight=function(){if(!(this.status!=goog.ime.chrome.os.Status.SELECT||this.cursorPos>=this.segments.length)){var a=this.segments[this.cursorPos],b=a.slice(0,1),a=a.slice(1);""==a?this.segments=this.segments.slice(0,this.cursorPos).concat(this.segments.slice(this.cursorPos+1)):this.segments[this.cursorPos]=a;this.source+=b;this.highlightIndex=-1;this.dispatchEvent(goog.ime.chrome.os.EventType.MODELUPDATED);this.holdSelectStatus_=!0;this.fetchCandidates_()}};
goog.ime.chrome.os.Model.prototype.notifyUpdates=function(a){a?(this.dispatchEvent(goog.ime.chrome.os.EventType.COMMIT),this.clear()):this.dispatchEvent(goog.ime.chrome.os.EventType.MODELUPDATED)};
goog.ime.chrome.os.Model.prototype.clear=function(){this.status!=goog.ime.chrome.os.Status.INIT&&this.dispatchEvent(goog.ime.chrome.os.EventType.CLOSING);this.decoder_&&this.decoder_.clear();this.source="";this.commitPos=this.cursorPos=0;this.segments=[];this.context="";this.highlightIndex=-1;this.candidates=[];this.status=goog.ime.chrome.os.Status.INIT;this.holdSelectStatus_=!1};goog.ime.chrome.os.Model.prototype.abort=function(){this.clear()};
goog.ime.chrome.os.Model.prototype.reset=function(){this.clear();this.decoder_&&(this.decoder_.persist(),this.decoder_=null);this.ready=!1};goog.ime.chrome.os.Model.prototype.enterSelect=function(){this.enterSelectInternal();this.notifyUpdates()};goog.ime.chrome.os.Model.prototype.enterSelectInternal=function(){this.status=goog.ime.chrome.os.Status.SELECT;this.highlightIndex=0};
goog.ime.chrome.os.Model.prototype.setInputTool=function(a){this.clear();var b=this.configFactory.getCurrentConfig();this.ready=!1;this.decoder_=new goog.ime.offline.Decoder(a,goog.bind(this.notifyDataReady_,this),b.fuzzyExpansions,b.enableUserDict)};goog.ime.chrome.os.Model.prototype.setFuzzyExpansions=function(a,b){var c=this.configFactory.getConfig(a);c.fuzzyExpansions=b;c==this.configFactory.getCurrentConfig()&&this.decoder_.updateFuzzyPairs(c.fuzzyExpansions)};
goog.ime.chrome.os.Model.prototype.enableUserDict=function(a,b){var c=this.configFactory.getConfig(a);c.enableUserDict=!0;c==this.configFactory.getCurrentConfig()&&this.decoder_.enableUserDict(b)};
goog.ime.chrome.os.Model.prototype.updateSource=function(a){this.source.length+a.length>this.configFactory.getCurrentConfig().maxInputLen&&this.selectCandidate(void 0,"");this.source+=a;this.highlightIndex=-1;this.status==goog.ime.chrome.os.Status.INIT&&this.dispatchEvent(goog.ime.chrome.os.EventType.OPENING);this.dispatchEvent(goog.ime.chrome.os.EventType.MODELUPDATED);this.status==goog.ime.chrome.os.Status.SELECT&&(this.holdSelectStatus_=!0);this.fetchCandidates_()};
goog.ime.chrome.os.Model.prototype.revert=function(){if(this.status!=goog.ime.chrome.os.Status.FETCHING){this.status==goog.ime.chrome.os.Status.SELECT&&(this.holdSelectStatus_=!0);var a="";if(0<this.commitPos){for(var b=0;b<this.commitPos;++b)this.segments[b]=this.tokens[b];this.commitPos=0}else 0<this.cursorPos&&(b=this.segments[this.cursorPos-1],a=b.slice(-1),(b=b.slice(0,-1))?this.segments[this.cursorPos-1]=b:(this.segments=this.segments.slice(0,this.cursorPos-1).concat(this.segments.slice(this.cursorPos)),
this.cursorPos--));this.source=this.segments.slice(this.commitPos,this.cursorPos).join("");""==this.source?this.notifyUpdates(!0):(this.notifyUpdates(),"'"==a&&this.decoder_.clear(),this.fetchCandidates_())}};
goog.ime.chrome.os.Model.prototype.selectCandidate=function(a,b){if(this.status!=goog.ime.chrome.os.Status.FETCHING)if(this.status=goog.ime.chrome.os.Status.FETCHING,-1==a)this.notifyUpdates(!0),this.clear();else{var c=this.candidates[a?a:this.highlightIndex];if(c){for(var d="",e=0;e<c.range;++e)d+=this.segments[e+this.commitPos];this.tokens[this.commitPos]=d;this.segments[this.commitPos]=c.target;this.commitPos++;this.segments=this.segments.slice(0,this.commitPos).concat(this.segments.slice(this.commitPos-
1+c.range));this.commitPos==this.segments.length||void 0!=b?(this.decoder_.addUserCommits(this.tokens.join(""),this.segments.join("")),this.notifyUpdates(!0),this.clear()):(this.highlightIndex=-1,this.source=this.segments.slice(this.commitPos,this.cursorPos).join(""),this.decoder_.clear(),this.fetchCandidates_())}else this.notifyUpdates(!0),this.clear()}};
goog.ime.chrome.os.Model.prototype.fetchCandidates_=function(){if(this.decoder_&&this.decoder_.isReady()){this.status=goog.ime.chrome.os.Status.FETCHING;var a=this.decoder_.decode(this.source,this.configFactory.getCurrentConfig().requestNum);if(a){var b=a.candidates,a=a.tokens,c=this.segments.slice(0,this.commitPos).concat(a),d=this.segments.slice(this.cursorPos);this.source=a.join("");this.segments=c.concat(d);this.cursorPos=c.length;this.candidates=[];for(a=0;a<b.length;a++)this.candidates.push(new goog.ime.chrome.os.Candidate(b[a].target.toString(),
Number(b[a].range)));this.status=goog.ime.chrome.os.Status.FETCHED;(this.configFactory.getCurrentConfig().autoHighlight||this.holdSelectStatus_)&&this.enterSelectInternal()}else this.status=goog.ime.chrome.os.Status.FETCHED,(this.configFactory.getCurrentConfig().autoHighlight||this.holdSelectStatus_)&&this.enterSelectInternal(),this.candidates=[];this.notifyUpdates()}};goog.ime.chrome.os.Model.prototype.notifyDataReady_=function(){this.ready=!0};goog.ime.chrome.os.View=function(a){this.model=a;this.configFactory=goog.ime.chrome.os.ConfigFactory.getInstance()};goog.ime.chrome.os.View.prototype.context_=null;goog.ime.chrome.os.View.prototype.inputToolCode_="";goog.ime.chrome.os.View.prototype.setContext=function(a){this.context_=a};goog.ime.chrome.os.View.prototype.updateInputTool=function(){this.inputToolCode_=this.configFactory.getInputTool();this.updateItems()};
goog.ime.chrome.os.View.prototype.updateItems=function(){if(this.inputToolCode_){var a=this.configFactory.getCurrentConfig().states,b=[],c;for(c in a)b.push({id:c,label:a[c].desc,checked:a[c].value,enabled:!0,visible:!0}),chrome.input.ime.setMenuItems({engineID:this.inputToolCode_,items:b})}};goog.ime.chrome.os.View.prototype.show=function(){this.inputToolCode_&&chrome.input.ime.setCandidateWindowProperties({engineID:this.inputToolCode_,properties:{visible:!0}})};
goog.ime.chrome.os.View.prototype.hide=function(){this.inputToolCode_&&chrome.input.ime.setCandidateWindowProperties({engineID:this.inputToolCode_,properties:{visible:!1}});this.context_&&(chrome.input.ime.clearComposition({contextID:this.context_.contextID},function(a){}),chrome.input.ime.setCandidates({contextID:this.context_.contextID,candidates:[]}))};
goog.ime.chrome.os.View.prototype.refresh=function(){if(this.context_){var a=this.model.segments,b=a.slice(0,this.model.cursorPos),c=a.slice(this.model.cursorPos),a=a.slice(this.model.commitPos,this.model.cursorPos).join(""),b=b.join(" ")+this.model.source.slice(a.length),a=b.length;0<c.length&&(b+=" "+c.join(" "));b=this.configFactory.getCurrentConfig().transformView(b);chrome.input.ime.setComposition({contextID:this.context_.contextID,text:b,cursor:a});this.showCandidates()}};
goog.ime.chrome.os.View.prototype.showCandidates=function(){var a=this.model.getPageIndex(),b=this.configFactory.getCurrentConfig().pageSize,a=a*b,c=a+b;c>this.model.candidates.length&&(c=this.model.candidates.length);for(var d=[],e=a;e<c;e++)d.push({candidate:this.model.candidates[e].target,label:(e+1-a).toString(),id:e-a});chrome.input.ime.setCandidates({contextID:this.context_.contextID,candidates:d});c>a?(d=0<=this.model.highlightIndex,chrome.input.ime.setCandidateWindowProperties({engineID:this.inputToolCode_,
properties:{visible:!0,cursorVisible:d,vertical:!0,pageSize:c-a}}),d&&chrome.input.ime.setCursorPosition({contextID:this.context_.contextID,candidateID:this.model.highlightIndex%b})):chrome.input.ime.setCandidateWindowProperties({engineID:this.inputToolCode_,properties:{visible:!1}})};goog.ime.chrome.os.Controller=function(){this.model=new goog.ime.chrome.os.Model;this.view=new goog.ime.chrome.os.View(this.model);this.configFactory=goog.ime.chrome.os.ConfigFactory.getInstance();this.eventHandler_=new goog.events.EventHandler(this);this.eventHandler_.listen(this.model,goog.ime.chrome.os.EventType.COMMIT,this.handleCommitEvent).listen(this.model,goog.ime.chrome.os.EventType.OPENING,this.handleOpeningEvent).listen(this.model,goog.ime.chrome.os.EventType.CLOSING,this.handleClosingEvent).listen(this.model,
goog.ime.chrome.os.EventType.MODELUPDATED,this.handleModelUpdatedEvent)};goog.inherits(goog.ime.chrome.os.Controller,goog.Disposable);goog.ime.chrome.os.Controller.prototype.context_=null;goog.ime.chrome.os.Controller.prototype.keyActionTable_=null;goog.ime.chrome.os.Controller.prototype.shortcutTable_=null;goog.ime.chrome.os.Controller.prototype.lastKeyDownIsShift_=!1;
goog.ime.chrome.os.Controller.prototype.activate=function(a){this.configFactory.setInputTool(a);this.model.setInputTool(a);this.view.updateInputTool();this.keyActionTable_=this.getKeyActionTable();this.shortcutTable_=this.getShortcutTable()};goog.ime.chrome.os.Controller.prototype.deactivate=function(){this.configFactory.setInputTool("");this.model.reset();this.view.updateInputTool();this.shortcutTable_=this.keyActionTable_=null};
goog.ime.chrome.os.Controller.prototype.register=function(a){this.context_=a;this.view.setContext(a);this.model.clear()};goog.ime.chrome.os.Controller.prototype.unregister=function(){this.context_=null;this.view.setContext(null);this.model.clear()};goog.ime.chrome.os.Controller.prototype.reset=function(){this.model.abort()};goog.ime.chrome.os.Controller.prototype.setFuzzyExpansions=function(a,b,c){var d=[];if(b)for(var e in c)c[e]&&d.push(e);this.model.setFuzzyExpansions(a,d)};
goog.ime.chrome.os.Controller.prototype.setUserDictEnabled=function(a,b){this.model.enableUserDict(a,b)};goog.ime.chrome.os.Controller.prototype.setPageMoveChars=function(a,b,c){if(a=this.configFactory.getConfig(a))a.pageupCharReg=b?RegExp("["+b+"]"):/xyz/g,a.pagedownCharReg=c?RegExp("["+c+"]"):/xyz/g,this.keyActionTable_=this.getKeyActionTable()};
goog.ime.chrome.os.Controller.prototype.setInputToolStates=function(a,b,c,d){a=this.configFactory.getConfig(a);var e=goog.ime.chrome.os.StateID;a&&(a.states[e.LANG].value=b,a.states[e.SBC].value=c,a.states[e.PUNC].value=d)};goog.ime.chrome.os.Controller.prototype.setPageSettings=function(a,b,c,d){if(a=this.configFactory.getConfig(a))a.layout=b,a.selectKeys=c,a.pageSize=d,this.keyActionTable_=this.getKeyActionTable()};
goog.ime.chrome.os.Controller.prototype.switchInputToolState=function(a){var b=this.configFactory.getCurrentConfig();b.states[a].value=!b.states[a].value;var c=goog.ime.chrome.os.StateID;a==c.LANG&&(b.states[c.PUNC].value=b.states[c.LANG].value);this.model.clear();this.view.updateItems();this.view.hide()};
goog.ime.chrome.os.Controller.prototype.handleEvent=function(a){var b=this.configFactory.getInputTool();if(!(this.context_&&b&&this.keyActionTable_&&this.model.ready))return!1;if(this.shortcutTable_&&this.handleKeyInActionTable_(a,this.shortcutTable_)||this.preProcess(a))return!0;var b=this.configFactory.getCurrentConfig(),c=goog.ime.chrome.os.StateID.LANG;if(b.states[c]&&!b.states[c].value)return!1;if(this.handleKeyInActionTable_(a,this.keyActionTable_))return!0;a.type==goog.ime.chrome.os.EventType.KEYDOWN&&
(a.key!=goog.ime.chrome.os.Key.INVALID&&a.key!=goog.ime.chrome.os.Modifier.SHIFT&&a.key!=goog.ime.chrome.os.Modifier.CTRL&&a.key!=goog.ime.chrome.os.Modifier.ALT&&this.model.status!=goog.ime.chrome.os.Status.INIT)&&this.model.selectCandidate(-1,"");return!1};
goog.ime.chrome.os.Controller.prototype.preProcess=function(a){return a.type!=goog.ime.chrome.os.EventType.KEYDOWN||this.model.status!=goog.ime.chrome.os.Status.INIT||a.ctrlKey||a.altKey?!1:(a=this.configFactory.getCurrentConfig().preTransform(a.key))?(this.context_&&chrome.input.ime.commitText({contextID:this.context_.contextID,text:a}),!0):!1};
goog.ime.chrome.os.Controller.prototype.processCharKey=function(a){a=this.configFactory.getCurrentConfig().transform(this.model.source,a.key);if(!a)return this.model.status!=goog.ime.chrome.os.Status.INIT;this.model.updateSource(a);return!0};
goog.ime.chrome.os.Controller.prototype.handleKeyInActionTable_=function(a,b){for(var c=goog.ime.chrome.os.Modifier,d=this.getKey_(a),e=0,f;f=b[e];e++)if(a.type==f[0]){var g=f[1];if(!(g==c.SHIFT&&!a.shiftKey||(g==c.CTRL&&!a.ctrlKey||g==c.ALT&&!a.altKey)||0==g&&(a.ctrlKey||a.altKey||a.shiftKey)||f[2]&&!(d==f[2]||1==d.length&&d.match(f[2]))||f[3]&&this.model.status!=f[3]||f[4]&&!f[4]()||!1==f[5].apply(f[6],void 0!=f[7]?f.slice(7):[a])))return!0}return!1};
goog.ime.chrome.os.Controller.prototype.processNumberKey=function(a){a=this.configFactory.getCurrentConfig().selectKeys.indexOf(a.key);if(0>a)return!0;var b=this.configFactory.getCurrentConfig().pageSize;0<=a&&a<b&&(a=this.model.getPageIndex()*b+a,this.model.selectCandidate(a));return!0};goog.ime.chrome.os.Controller.prototype.processPuncKey=function(a){a=this.configFactory.getCurrentConfig().postTransform(a.key);this.model.selectCandidate(void 0,a);return!0};
goog.ime.chrome.os.Controller.prototype.processRevertKey=function(a){this.model.revert();return!0};goog.ime.chrome.os.Controller.prototype.processCommitKey=function(a){a.key==goog.ime.chrome.os.Key.ENTER&&this.model.status==goog.ime.chrome.os.Status.SELECT?this.model.selectCandidate(-1,""):this.model.selectCandidate(void 0,"");return!0};goog.ime.chrome.os.Controller.prototype.processSelectKey=function(a){this.model.status==goog.ime.chrome.os.Status.FETCHED&&this.model.enterSelect();return!0};
goog.ime.chrome.os.Controller.prototype.processAbortKey=function(a){this.model.abort();return!0};goog.ime.chrome.os.Controller.prototype.handleOpeningEvent=function(){this.view.show()};goog.ime.chrome.os.Controller.prototype.handleClosingEvent=function(){this.view.hide()};goog.ime.chrome.os.Controller.prototype.handleModelUpdatedEvent=function(){this.view.refresh()};
goog.ime.chrome.os.Controller.prototype.handleCommitEvent=function(a){this.context_&&(this.configFactory.getCurrentConfig(),chrome.input.ime.commitText({contextID:this.context_.contextID,text:this.model.segments.join("")}))};
goog.ime.chrome.os.Controller.prototype.getKeyActionTable=function(){var a=goog.ime.chrome.os.EventType,b=goog.ime.chrome.os.Key,c=goog.ime.chrome.os.Modifier,d=goog.ime.chrome.os.Status,e=this.configFactory.getCurrentConfig(),f=this,g=function(){return f.model.status!=goog.ime.chrome.os.Status.INIT},h=function(){return f.model.status!=goog.ime.chrome.os.Status.INIT&&f.model.status!=goog.ime.chrome.os.Status.SELECT};return[[a.KEYDOWN,0,b.PAGE_UP,null,g,this.model.movePage,this.model,1],[a.KEYDOWN,
0,e.pageupCharReg,d.SELECT,null,this.model.movePage,this.model,1],[a.KEYDOWN,0,b.PAGE_DOWN,null,g,this.model.movePage,this.model,-1],[a.KEYDOWN,0,e.pagedownCharReg,d.SELECT,null,this.model.movePage,this.model,-1],[a.KEYDOWN,0,RegExp("["+e.selectKeys+"]"),d.SELECT,null,this.processNumberKey,this],[a.KEYDOWN,0,b.SPACE,null,h,this.processSelectKey,this],[a.KEYDOWN,0,b.SPACE,null,g,this.processCommitKey,this],[a.KEYDOWN,0,b.DOWN,null,h,this.processSelectKey,this],[a.KEYDOWN,0,b.ENTER,null,g,this.processCommitKey,
this],[a.KEYDOWN,0,b.BACKSPACE,null,function(){return f.model.status==goog.ime.chrome.os.Status.FETCHED||f.model.status==goog.ime.chrome.os.Status.SELECT},this.processRevertKey,this],[a.KEYDOWN,0,b.UP,null,g,this.model.moveHighlight,this.model,-1],[a.KEYDOWN,0,b.DOWN,null,g,this.model.moveHighlight,this.model,1],[a.KEYDOWN,0,b.LEFT,null,g,this.model.moveCursorLeft,this.model],[a.KEYDOWN,0,b.RIGHT,null,g,this.model.moveCursorRight,this.model],[a.KEYDOWN,0,b.ESC,null,g,this.processAbortKey,this],[a.KEYDOWN,
0,e.editorCharReg,null,null,this.processCharKey,this],[a.KEYDOWN,c.SHIFT,e.editorCharReg,null,null,this.processCharKey,this],[a.KEYDOWN,0,e.punctuationReg,null,g,this.processPuncKey,this]]};
goog.ime.chrome.os.Controller.prototype.getShortcutTable=function(){var a=[],b=goog.ime.chrome.os.EventType,c=goog.ime.chrome.os.Modifier,d=this.configFactory.getCurrentConfig(),e=this,f;for(f in d.states){var g=d.states[f];1==g.shortcut.length&&g.shortcut[0]==c.SHIFT?(a.unshift([b.KEYDOWN,null,null,null,null,this.updateLastKeyIsShift_,this]),a.push([b.KEYUP,c.SHIFT,c.SHIFT,null,function(){return e.lastKeyDownIsShift_},this.switchInputToolState,this,f])):1<=g.shortcut.length&&a.push([b.KEYDOWN,g.shortcut[1],
g.shortcut[0],null,null,this.switchInputToolState,this,f])}return a};goog.ime.chrome.os.Controller.prototype.updateLastKeyIsShift_=function(a){this.getKey_(a)!=goog.ime.chrome.os.Modifier.SHIFT||a.altKey||a.ctrlKey?this.lastKeyDownIsShift_=!1:this.lastKeyDownIsShift_=!0;return!1};goog.ime.chrome.os.Controller.prototype.getKey_=function(a){var b=a.key;if(b==goog.ime.chrome.os.Key.INVALID){var c=goog.ime.chrome.os.Modifier,d;for(d in c){var e=c[d];0==a.code.indexOf(e)&&(b=e)}}return b};goog.ime.chrome.os.Background=function(){this.controller_=new goog.ime.chrome.os.Controller;this.localStorageHandlerFactory_=new goog.ime.chrome.os.LocalStorageHandlerFactory;chrome.extension.onRequest.addListener(goog.bind(this.processRequest,this));this.init_()};
goog.ime.chrome.os.Background.prototype.init_=function(){this.updateSettingsFromLocalStorage_();var a=this;chrome.input.ime.onActivate.addListener(function(b){a.controller_.activate(b)});chrome.input.ime.onDeactivated.addListener(function(){a.controller_.deactivate()});chrome.input.ime.onFocus.addListener(function(b){a.controller_.register(b)});chrome.input.ime.onBlur.addListener(function(b){a.controller_.unregister()});var b=chrome.input.ime.onReset;b&&b.addListener(function(b){a.controller_.reset()});
chrome.input.ime.onKeyEvent.addListener(function(b,d){return a.controller_.handleEvent(d)});chrome.input.ime.onCandidateClicked.addListener(function(b,d,e){a.controller_.processNumberKey({key:d+1})});chrome.input.ime.onMenuItemActivated.addListener(function(b,d){a.controller_.switchInputToolState(d)});chrome.inputMethodPrivate&&chrome.inputMethodPrivate.startIme&&chrome.inputMethodPrivate.startIme()};
goog.ime.chrome.os.Background.prototype.updateSettingsFromLocalStorage_=function(a){if(a)this.localStorageHandlerFactory_.getLocalStorageHandler(a).updateControllerSettings(this.controller_);else{a=this.localStorageHandlerFactory_.getAllLocalStorageHandlers();for(var b=0;b<a.length;++b)a[b].updateControllerSettings(this.controller_)}};goog.ime.chrome.os.Background.prototype.processRequest=function(a){a.update&&this.updateSettingsFromLocalStorage_(a.update)};(function(){new goog.ime.chrome.os.Background})();
